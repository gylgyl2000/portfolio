"use strict";(self.webpackChunkmon_web_dev_wiki=self.webpackChunkmon_web_dev_wiki||[]).push([[7246],{16278:function(e,n,r){r.r(n),r.d(n,{frontMatter:function(){return d},contentTitle:function(){return l},metadata:function(){return m},toc:function(){return u},default:function(){return c}});var a=r(87462),s=r(63366),o=(r(67294),r(3905)),t=(r(9877),r(58215),r(56222)),i=["components"],d={sidebar_position:3},l="Cr\xe9ez une API RESTful",m={unversionedId:"OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Creez_une_API_RESTful",id:"OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Creez_une_API_RESTful",title:"Cr\xe9ez une API RESTful",description:"Configurez votre base de donn\xe9es",source:"@site/docs/OpenClassrooms/6-Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/2-Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/2-Creez_une_API_RESTful.mdx",sourceDirName:"OpenClassrooms/6-Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/2-Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB",slug:"/OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Creez_une_API_RESTful",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Creez_une_API_RESTful",editUrl:"https://github.com/gylgyl2000/Mon_Web_Dev_Wiki/edit/master/website/docs/OpenClassrooms/6-Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/2-Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/2-Creez_une_API_RESTful.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"openClassroomsSidebar",previous:{title:"Cr\xe9ez un serveur Express simple",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Creez_un_serveur_Express_simple"},next:{title:"Mettez en place un syst\xe8me d'authentification sur votre application",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_une_API_securisee_pour_une_application_d_avis_gastronomiques/Passez_au_Full_stack_avec_Node_js_Express_et_MongoDB/Mettez_en_place_un_syst\xe8me_d_authentification_sur_votre_application"}},u=[{value:"Configurez votre base de donn\xe9es",id:"configurez-votre-base-de-donn\xe9es",children:[{value:"Configurez\xa0MongoDB Atlas",id:"configurezmongodb-atlas",children:[],level:3},{value:"Connectez votre API\xa0\xe0 votre <em>cluster</em> MongoDB",id:"connectez-votre-api\xe0-votre-cluster-mongodb",children:[],level:3}],level:2},{value:"Cr\xe9ez un sch\xe9ma de donn\xe9es",id:"cr\xe9ez-un-sch\xe9ma-de-donn\xe9es",children:[{value:"Cr\xe9ez un sch\xe9ma\xa0Thing",id:"cr\xe9ez-un-sch\xe9mathing",children:[],level:3}],level:2},{value:"Enregistrez et r\xe9cup\xe9rez des donn\xe9es",id:"enregistrez-et-r\xe9cup\xe9rez-des-donn\xe9es",children:[{value:"Enregistrement des Things\xa0dans la base de donn\xe9es",id:"enregistrement-des-thingsdans-la-base-de-donn\xe9es",children:[],level:3},{value:"R\xe9cup\xe9ration de la liste de\xa0Things\xa0en vente",id:"r\xe9cup\xe9ration-de-la-liste-dethingsen-vente",children:[],level:3},{value:"R\xe9cup\xe9ration d&#39;un\xa0Thing sp\xe9cifique",id:"r\xe9cup\xe9ration-dunthing-sp\xe9cifique",children:[],level:3}],level:2},{value:"Modifiez et supprimez des donn\xe9es",id:"modifiez-et-supprimez-des-donn\xe9es",children:[{value:"Mettez \xe0 jour un\xa0Thing existant",id:"mettez-\xe0-jour-unthing-existant",children:[],level:3},{value:"Suppression d&#39;un\xa0Thing",id:"suppression-dunthing",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9",children:[],level:3}],level:2},{value:"Quiz : Savez-vous impl\xe9menter le CRUD ?",id:"quiz--savez-vous-impl\xe9menter-le-crud-",children:[{value:"Comp\xe9tences \xe9valu\xe9es",id:"comp\xe9tences-\xe9valu\xe9es",children:[],level:4},{value:"Description",id:"description",children:[],level:4},{value:"Question 1 : Quand tout fonctionnera bien, l&#39;application de test affichera un mot secret. Quel est ce mot secret ? S\xe9lectionnez-le dans la liste ci-dessous :",id:"question-1--quand-tout-fonctionnera-bien-lapplication-de-test-affichera-un-mot-secret-quel-est-ce-mot-secret--s\xe9lectionnez-le-dans-la-liste-ci-dessous-",children:[],level:4}],level:2}],p={toc:u};function c(e){var n=e.components,r=(0,s.Z)(e,i);return(0,o.mdx)("wrapper",(0,a.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"cr\xe9ez-une-api-restful"},"Cr\xe9ez une API RESTful"),(0,o.mdx)("h2",{id:"configurez-votre-base-de-donn\xe9es"},"Configurez votre base de donn\xe9es"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/6466348-configurez-votre-base-de-donnees"},"Configurez votre base de donn\xe9es - Passez au Full stack avec Node.js, Express et MongoDB - OpenClassrooms")),(0,o.mdx)(t.fG,{vimeoId:"373128974",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Jusqu'\xe0 pr\xe9sent, nous n'avons pas pu faire persister de donn\xe9es\xa0ou rendre notre application enti\xe8rement dynamique. Mais tout cela\nest sur le point de changer, car nous int\xe9grons la couche de base de donn\xe9es de notre serveur : MongoDB."),(0,o.mdx)("p",null,"Bien qu'il soit possible de t\xe9l\xe9charger et d'ex\xe9cuter MongoDB\xa0sur votre propre machine (reportez-vous au ",(0,o.mdx)("a",{parentName:"p",href:"https://www.mongodb.com/download-center?initial=true#community"},"site Web de MongoDB"),"\npour en savoir plus), pour ce cours nous utiliserons la couche\xa0gratuite de MongoDB Atlas, la \xab database as a service \xbb (base de\ndonn\xe9es en tant que service)."),(0,o.mdx)("h3",{id:"configurezmongodb-atlas"},"Configurez\xa0MongoDB Atlas"),(0,o.mdx)(t.fG,{vimeoId:"374618951",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Acc\xe9dez\xa0au\xa0",(0,o.mdx)("a",{parentName:"p",href:"https://www.mongodb.com/cloud/atlas"},"site Web de MongoDB"),"\xa0et inscrivez-vous pour obtenir un compte gratuit. Une fois que\nvous avez acc\xe8s \xe0 votre tableau de bord, cr\xe9ez un ",(0,o.mdx)("em",{parentName:"p"},"cluster"),"\xa0puis configurez-le avec l'",(0,o.mdx)("strong",{parentName:"p"},"option AWS")," et\xa0",(0,o.mdx)("strong",{parentName:"p"},"uniquement les options\ngratuites"),"\xa0afin\xa0de pouvoir d\xe9velopper\xa0gratuitement."),(0,o.mdx)("p",null,"Pendant le d\xe9marrage de votre ",(0,o.mdx)("em",{parentName:"p"},"cluster"),", vous pouvez acc\xe9der \xe0 l'onglet\xa0",(0,o.mdx)("strong",{parentName:"p"},"Database Access"),". D'abord, vous\xa0devrez ajouter un\nutilisateur disposant de la capacit\xe9 de lecture et d'\xe9criture dans n'importe quelle base de donn\xe9es.\xa0Choisissez\xa0le nom d'utilisateur\nainsi que le mot de passe de votre choix\xa0et ",(0,o.mdx)("strong",{parentName:"p"},"notez-les"),",\xa0car vous en aurez besoin pour connecter votre API \xe0 votre ",(0,o.mdx)("em",{parentName:"p"},"cluster"),"."),(0,o.mdx)("figure",null,(0,o.mdx)("img",{src:"https://user.oc-static.com/upload/2019/10/29/1572369906457_Capture%20d%E2%80%99e%CC%81cran%202019-10-29%20a%CC%80%2018.23.04.png",alt:"Cr\xe9ation d'un nouvel utilisateur en \xab read and write \xbb"}),(0,o.mdx)("figcaption",null,"Cr\xe9ation d'un nouvel utilisateur en \xab read and write \xbb")),(0,o.mdx)("p",null,"Vous devrez \xe9galement acc\xe9der \xe0 l'onglet ",(0,o.mdx)("strong",{parentName:"p"},"Network Access"),", cliquer sur ",(0,o.mdx)("em",{parentName:"p"},"Add IP Adress")," et autoriser l'acc\xe8s depuis n'importe o\xf9\n(",(0,o.mdx)("em",{parentName:"p"},"Add access from Anywhere"),")."),(0,o.mdx)("p",null,"Une fois la cr\xe9ation de votre ",(0,o.mdx)("em",{parentName:"p"},"cluster")," termin\xe9e, vous pouvez passer \xe0 la section suivante."),(0,o.mdx)("h3",{id:"connectez-votre-api\xe0-votre-cluster-mongodb"},"Connectez votre API\xa0\xe0 votre ",(0,o.mdx)("em",{parentName:"h3"},"cluster")," MongoDB"),(0,o.mdx)(t.fG,{vimeoId:"374618981",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Depuis\xa0MongoDB Atlas, cliquez sur le bouton\xa0",(0,o.mdx)("strong",{parentName:"p"},"Connect")," et choisissez\xa0",(0,o.mdx)("strong",{parentName:"p"},"Connect your application"),". S\xe9lectionnez bien la version la\nplus r\xe9cente du driver Node.js, puis\xa0",(0,o.mdx)("strong",{parentName:"p"},"Connection String Only"),", et faites une copie de la cha\xeene de caract\xe8res retourn\xe9e."),(0,o.mdx)("p",null,"De retour sur votre projet, installez le package Mongoose en ex\xe9cutant, \xe0 partir du dossier\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"backend"),", la commande suivante :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"npm install --save mongoose\n")),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"Mongoose est un package qui facilite les interactions avec notre base de donn\xe9es MongoDB gr\xe2ce \xe0 des fonctions extr\xeamement utiles."))),(0,o.mdx)("p",null,"Une fois l'installation termin\xe9e, importez\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"mongoose"),"\xa0dans votre fichier\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"app.js"),"\xa0en ajoutant la constante suivante :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"const mongoose = require('mongoose');\n")),(0,o.mdx)("p",null,"Juste en dessous de votre d\xe9claration de constante\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"app"),", ajoutez la ligne suivante. Veillez \xe0 remplacer l'adresse SRV par la v\xf4tre\net la cha\xeene\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"<PASSWORD>"),"\xa0par votre mot de passe utilisateur MongoDB :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"mongoose.connect('mongodb+srv://jimbob:<PASSWORD>@cluster0-pme76.mongodb.net/test?retryWrites=true&w=majority',\n    { useNewUrlParser: true,\n      useUnifiedTopology: true })\n    .then(() => console.log('Connexion \xe0 MongoDB r\xe9ussie !'))\n    .catch(() => console.log('Connexion \xe0 MongoDB \xe9chou\xe9e !'));\n")),(0,o.mdx)("p",null,"Apr\xe8s\xa0enregistrement\xa0voire red\xe9marrage de votre serveur Node si n\xe9cessaire, vous devriez voir le message \xab Connexion \xe0\xa0MongoDB Atlas\nr\xe9ussie ! \xbb dans la\xa0console. Votre API est \xe0 pr\xe9sent connect\xe9e \xe0 votre base de donn\xe9es et nous pouvons commencer \xe0 cr\xe9er des routes\nserveur afin d'en b\xe9n\xe9ficier."),(0,o.mdx)("hr",null),(0,o.mdx)("h2",{id:"cr\xe9ez-un-sch\xe9ma-de-donn\xe9es"},"Cr\xe9ez un sch\xe9ma de donn\xe9es"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/6466362-creez-un-schema-de-donnees"},"Cr\xe9ez un sch\xe9ma de donn\xe9es - Passez au Full stack avec Node.js, Express et MongoDB - OpenClassrooms")),(0,o.mdx)(t.fG,{vimeoId:"373129062",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"L'un des avantages que nous avons \xe0 utiliser\xa0Mongoose\xa0pour g\xe9rer notre base de donn\xe9es MongoDB est que nous pouvons impl\xe9menter des\nsch\xe9mas de donn\xe9es stricts, qui permettent de rendre notre application plus robuste. Commen\xe7ons par cr\xe9er un sch\xe9ma\xa0",(0,o.mdx)("strong",{parentName:"p"},"Thing"),"\n(\xab chose\xa0\xbb) pour tout\xa0objet mis en vente dans notre application."),(0,o.mdx)("h3",{id:"cr\xe9ez-un-sch\xe9mathing"},"Cr\xe9ez un sch\xe9ma\xa0Thing"),(0,o.mdx)(t.fG,{vimeoId:"374619026",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Dans votre dossier\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"backend"),",\xa0cr\xe9ez un dossier appel\xe9\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"models"),"\xa0et, dans ce nouveau dossier,\xa0un fichier appel\xe9\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"thing.js"),"\xa0:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"const mongoose = require('mongoose');\n\nconst thingSchema = mongoose.Schema({\n    title: { type: String, required: true },\n    description: { type: String, required: true },\n    imageUrl: { type: String, required: true },\n    userId: { type: String, required: true },\n    price: { type: Number, required: true },\n});\n\nmodule.exports = mongoose.model('Thing', thingSchema);\n")),(0,o.mdx)("p",null,"Ici, voici ce que nous faisons :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"nous cr\xe9ons un sch\xe9ma de donn\xe9es qui contient les champs souhait\xe9s pour chaque Thing, indique\xa0leur type ainsi que leur caract\xe8re\n(obligatoire ou non). Pour cela, on utilise la m\xe9thode Schema mise \xe0 disposition par Mongoose. Pas besoin de mettre un champ pour\nl'Id puisqu'il est automatiquement g\xe9n\xe9r\xe9 par Mongoose,"),(0,o.mdx)("li",{parentName:"ul"},"ensuite, nous exportons ce sch\xe9ma en tant que mod\xe8le Mongoose appel\xe9 \xab Thing \xbb, le rendant par l\xe0 m\xeame disponible pour notre\napplication Express.")),(0,o.mdx)("p",null,"Ce mod\xe8le\xa0vous permettra non seulement d'appliquer notre structure de donn\xe9es,\xa0mais aussi de simplifier\xa0les op\xe9rations de lecture et\nd'\xe9criture dans la base de donn\xe9es comme vous le verrez dans les chapitres suivants."),(0,o.mdx)("hr",null),(0,o.mdx)("h2",{id:"enregistrez-et-r\xe9cup\xe9rez-des-donn\xe9es"},"Enregistrez et r\xe9cup\xe9rez des donn\xe9es"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/6466398-enregistrez-et-recuperez-des-donnees"},"Enregistrez et r\xe9cup\xe9rez des donn\xe9es - Passez au Full stack avec Node.js, Express et MongoDB - OpenClassrooms")),(0,o.mdx)(t.fG,{vimeoId:"373129161",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"En utilisant le mod\xe8le\xa0Thing que nous avons cr\xe9\xe9 dans le chapitre pr\xe9c\xe9dent, nous allons exploiter Mongoose. Vous verrez que\nl'enregistrement et la r\xe9cup\xe9ration de donn\xe9es dans la base de donn\xe9es est un jeu d'enfant ! Commen\xe7ons par impl\xe9menter correctement\nnotre route POST."),(0,o.mdx)("h3",{id:"enregistrement-des-thingsdans-la-base-de-donn\xe9es"},"Enregistrement des Things\xa0dans la base de donn\xe9es"),(0,o.mdx)(t.fG,{vimeoId:"374619056",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Pour pouvoir utiliser notre nouveau mod\xe8le Mongoose dans l'application, nous devons l'importer dans le fichier\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"app.js"),"\xa0:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"const Thing = require('./models/thing');\n")),(0,o.mdx)("p",null,"Maintenant, remplacez la logique de votre route POST par :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"app.post('/api/stuff', (req, res, next) => {\n    delete req.body._id;\n    const thing = new Thing({\n        ...req.body\n    });\n    thing.save()\n    .then(() => res.status(201).json({ message: 'Objet enregistr\xe9 !'}))\n    .catch(error => res.status(400).json({ error }));\n});\n")),(0,o.mdx)("p",null,"Ici, vous cr\xe9ez une instance de votre mod\xe8le\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0en lui passant un objet JavaScript\xa0contenant toutes les informations requises\ndu corps de\xa0requ\xeate analys\xe9 (en ayant supprim\xe9 en amont le faux ",(0,o.mdx)("inlineCode",{parentName:"p"},"_id"),"\xa0envoy\xe9 par le front-end)."),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"L'op\xe9rateur spread\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"..."),"\xa0est utilis\xe9 pour faire une copie de tous les \xe9l\xe9ments de\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"req.body"),". Pour plus d'informations sur\nl'op\xe9rateur spread, rendez-vous sur ",(0,o.mdx)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax"},"la documentation de MDN"),"."))),(0,o.mdx)("p",null,"Ce mod\xe8le comporte une m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"save()"),"\xa0qui enregistre simplement votre\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0dans la base de donn\xe9es."),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"La base de donn\xe9es MongoDB\xa0est fractionn\xe9e en\xa0",(0,o.mdx)("strong",{parentName:"p"},"collections")," : le nom de la collection est d\xe9fini par d\xe9faut sur le pluriel du nom\ndu mod\xe8le. Ici, ce sera\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Things"),"."))),(0,o.mdx)("p",null,"La m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"save()"),"\xa0renvoie une Promise. Ainsi, dans notre bloc\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"then()"),", nous renverrons une r\xe9ponse de r\xe9ussite avec un code 201 de\nr\xe9ussite. Dans notre bloc\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"catch()"),", nous renverrons une r\xe9ponse avec l'erreur g\xe9n\xe9r\xe9e par Mongoose ainsi qu'un code d'erreur 400."),(0,o.mdx)("h3",{id:"r\xe9cup\xe9ration-de-la-liste-dethingsen-vente"},"R\xe9cup\xe9ration de la liste de\xa0Things\xa0en vente"),(0,o.mdx)(t.fG,{vimeoId:"374619096",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"D\xe9sormais, nous pouvons impl\xe9menter notre route GET afin qu'elle renvoie tous les\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Things"),"\xa0dans la base de donn\xe9es :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"app.use('/api/stuff', (req, res, next) => {\n    Thing.find()\n        .then(things => res.status(200).json(things))\n        .catch(error => res.status(400).json({ error }));\n});\n")),(0,o.mdx)("p",null,"Dans l'exemple ci-dessus, nous utilisons la m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"find()"),"\xa0dans notre mod\xe8le\xa0Mongoose afin de renvoyer un tableau contenant tous\nles\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Things"),"\xa0dans notre base de donn\xe9es. \xc0 pr\xe9sent,\xa0si vous ajoutez un\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),",\xa0il doit s'afficher imm\xe9diatement sur votre page\nd'articles en vente."),(0,o.mdx)("p",null,"En revanche, si vous cliquez sur l'un des\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Things"),",\xa0l'affichage d'un seul \xe9l\xe9ment ne fonctionne pas. En effet, il tente d'effectuer\nun appel GET diff\xe9rent pour trouver un\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0individuel. Impl\xe9mentons cette route maintenant."),(0,o.mdx)("h3",{id:"r\xe9cup\xe9ration-dunthing-sp\xe9cifique"},"R\xe9cup\xe9ration d'un\xa0Thing sp\xe9cifique"),(0,o.mdx)(t.fG,{vimeoId:"374618836",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Ajoutons une autre route \xe0 notre application, juste apr\xe8s notre route POST :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"app.get('/api/stuff/:id', (req, res, next) => {\n    Thing.findOne({ _id: req.params.id })\n        .then(thing => res.status(200).json(thing))\n        .catch(error => res.status(404).json({ error }));\n});\n")),(0,o.mdx)("p",null,"Dans cette\xa0route :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"nous utilisons la m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"get()"),"\xa0pour r\xe9pondre uniquement aux demandes GET\xa0\xe0 cet endpoint ;"),(0,o.mdx)("li",{parentName:"ul"},"nous utilisons deux-points\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},":"),"\xa0en face du segment dynamique de la route pour la rendre accessible en tant que param\xe8tre ;"),(0,o.mdx)("li",{parentName:"ul"},"nous utilisons ensuite la m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"findOne()"),"\xa0dans\xa0notre mod\xe8le\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"Thing"),"\xa0pour trouver le\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"Thing"),"\xa0unique ayant le m\xeame\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"_id"),"\xa0que le\nparam\xe8tre\xa0de la requ\xeate\xa0;"),(0,o.mdx)("li",{parentName:"ul"},"ce\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"Thing"),"\xa0est ensuite\xa0retourn\xe9\xa0dans une Promise et envoy\xe9 au front-end ;"),(0,o.mdx)("li",{parentName:"ul"},"si aucun\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"Thing"),"\xa0n'est trouv\xe9 ou si une erreur se produit, nous envoyons\xa0une erreur 404\xa0au front-end,\xa0avec l'erreur g\xe9n\xe9r\xe9e.")),(0,o.mdx)("p",null,"Maintenant, notre application commence vraiment \xe0 prendre forme ! Nous pouvons cr\xe9er des objets et les voir appara\xeetre imm\xe9diatement\ndans notre boutique en ligne gr\xe2ce \xe0 la base de donn\xe9es. Et nous pouvons m\xeame ouvrir un objet en particulier pour obtenir les\ninformations de cet objet pr\xe9cis, via la base de donn\xe9es."),(0,o.mdx)("p",null,"Dans le chapitre suivant, nous impl\xe9menterons nos boutons Modifier et Supprimer pour terminer la partie\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0de notre\xa0API."),(0,o.mdx)("hr",null),(0,o.mdx)("h2",{id:"modifiez-et-supprimez-des-donn\xe9es"},"Modifiez et supprimez des donn\xe9es"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/6466426-modifiez-et-supprimez-des-donnees"},"Modifiez et supprimez des donn\xe9es - Passez au Full stack avec Node.js, Express et MongoDB - OpenClassrooms")),(0,o.mdx)(t.fG,{vimeoId:"373129265",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("h3",{id:"mettez-\xe0-jour-unthing-existant"},"Mettez \xe0 jour un\xa0Thing existant"),(0,o.mdx)(t.fG,{vimeoId:"374618877",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Ajoutons une autre route \xe0 notre application, juste en dessous de notre\xa0route GET\xa0individuelle. Cette fois, elle r\xe9pondra aux\xa0requ\xeates PUT :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"app.put('/api/stuff/:id', (req, res, next) => {\n    Thing.updateOne({ _id: req.params.id }, { ...req.body, _id: req.params.id })\n        .then(() => res.status(200).json({ message: 'Objet modifi\xe9 !'}))\n        .catch(error => res.status(400).json({ error }));\n});\n")),(0,o.mdx)("p",null,"Ci-dessus, nous exploitons la m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"updateOne()"),"\xa0dans notre mod\xe8le\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),". Cela nous permet de mettre \xe0 jour le\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0qui correspond \xe0 l'objet que nous passons\ncomme premier argument. Nous utilisons aussi le param\xe8tre\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"id"),"\xa0pass\xe9 dans la demande et le rempla\xe7ons par le\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0pass\xe9 comme\xa0second argument."),(0,o.mdx)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"!")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"L'utilisation du mot-cl\xe9\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"new"),"\xa0avec un mod\xe8le\xa0Mongoose\xa0cr\xe9e par d\xe9faut un champ ",(0,o.mdx)("inlineCode",{parentName:"p"},"_id"),". Utiliser ce mot-cl\xe9 g\xe9n\xe9rerait une erreur, car nous tenterions de modifier un\nchamp immuable dans un document de la base de donn\xe9es. Par cons\xe9quent, nous devons utiliser le param\xe8tre\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"id"),"\xa0de la\xa0requ\xeate\xa0pour configurer notre Thing\xa0avec le m\xeame\n",(0,o.mdx)("inlineCode",{parentName:"p"},"_id"),"\xa0qu'avant."))),(0,o.mdx)("p",null,"Vous pouvez maintenant tester votre nouvelle route : cliquez sur un\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0de l'application,\xa0puis sur son bouton Modifier, changez ses param\xe8tres puis sauvegardez.\nVous envoyez alors un\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Thing"),"\xa0modifi\xe9 au back-end. En revenant sur la page des articles, vous devriez retrouver votre article modifi\xe9."),(0,o.mdx)("h3",{id:"suppression-dunthing"},"Suppression d'un\xa0Thing"),(0,o.mdx)(t.fG,{vimeoId:"374618919",mdxType:"Vimeo"}),(0,o.mdx)("br",null),(0,o.mdx)("p",null,"Il est temps d'ajouter une derni\xe8re route, la route DELETE :"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"app.delete('/api/stuff/:id', (req, res, next) => {\n    Thing.deleteOne({ _id: req.params.id })\n        .then(() => res.status(200).json({ message: 'Objet supprim\xe9 !'}))\n        .catch(error => res.status(400).json({ error }));\n});\n")),(0,o.mdx)("p",null,"La m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"deleteOne()"),"\xa0de notre mod\xe8le fonctionne comme\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"findOne()"),"\xa0et\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"updateOne()"),"\xa0dans le sens o\xf9 nous lui passons un objet correspondant au document \xe0 supprimer.\nNous envoyons ensuite une r\xe9ponse de r\xe9ussite ou d'\xe9chec au front-end."),(0,o.mdx)("p",null,"F\xe9licitations ! D\xe9sormais, votre application impl\xe9mente le ",(0,o.mdx)("strong",{parentName:"p"},"CRUD")," complet :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"create")," (cr\xe9ation de ressources) ;"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"read"),"\xa0(lecture de ressources) ;"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"update"),"\xa0(modification de ressources) ;"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"delete")," (suppression de ressources).")),(0,o.mdx)("p",null,"L'application permet donc d\xe9sormais un parcours client complet\xa0!"),(0,o.mdx)("h3",{id:"en-r\xe9sum\xe9"},"En r\xe9sum\xe9"),(0,o.mdx)("p",null,"Dans cette partie du cours :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"vous avez configur\xe9 votre base de donn\xe9es MongoDB\xa0et l'avez connect\xe9e \xe0 votre application\xa0Express ;"),(0,o.mdx)("li",{parentName:"ul"},"vous avez utilis\xe9 Mongoose\xa0pour cr\xe9er un mod\xe8le de donn\xe9es afin de faciliter les op\xe9rations de la base de donn\xe9es ;"),(0,o.mdx)("li",{parentName:"ul"},"vous avez impl\xe9ment\xe9, dans votre application Express, les routes CRUD qui exploitent votre mod\xe8le de donn\xe9es Mongoose, rendant ainsi votre application enti\xe8rement\ndynamique.")),(0,o.mdx)("p",null,"Dans la partie suivante de ce cours, nous nous pencherons sur une th\xe9matique extr\xeamement importante : ",(0,o.mdx)("strong",{parentName:"p"},"la s\xe9curit\xe9"),"."),(0,o.mdx)("hr",null),(0,o.mdx)("h2",{id:"quiz--savez-vous-impl\xe9menter-le-crud-"},"Quiz : Savez-vous impl\xe9menter le CRUD ?"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6390246-passez-au-full-stack-avec-node-js-express-et-mongodb/exercises/3732"},"Savez-vous impl\xe9menter le CRUD ? - OpenClassrooms")),(0,o.mdx)("h4",{id:"comp\xe9tences-\xe9valu\xe9es"},"Comp\xe9tences \xe9valu\xe9es"),(0,o.mdx)("i",{class:"bi bi-check2-circle"})," Cr\xe9er une API REST avec Node, Express et MongoDB",(0,o.mdx)("hr",null),(0,o.mdx)("h4",{id:"description"},"Description"),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"Ce quiz est en fait un r\xe9el ",(0,o.mdx)("strong",{parentName:"p"},"cas pratique"),", dans lequel vous aurez l'opportunit\xe9 de tester vos comp\xe9tences en codant !"))),(0,o.mdx)("p",null,"Pour pouvoir r\xe9pondre correctement, il vous faudra cr\xe9er une API fonctionnelle comme nous venons de le faire pendant le cours. Votre API devra \xeatre\nconnect\xe9e \xe0 une base de donn\xe9es, car les diff\xe9rentes op\xe9rations CRUD seront test\xe9es et v\xe9rifi\xe9es !"),(0,o.mdx)("p",null,"Vous allez cr\xe9er une API basique pour une boutique en ligne qui permet de cr\xe9er, lire, modifier et supprimer des produits (",(0,o.mdx)("inlineCode",{parentName:"p"},"Product"),"). Les\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Product"),"\nauront quatre champs obligatoires :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"name"),"\xa0: le nom du produit, de type String"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"description"),"\xa0: la description du produit, de type String"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"price"),"\xa0: le prix du produit, de type Number"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"inStock"),"\xa0: si le produit est en stock, de type Boolean.")),(0,o.mdx)("p",null,"Vous allez impl\xe9menter cinq routes :"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"GET:\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"/api/products"),(0,o.mdx)("br",null),"\nRetournera tous les produits sous la forme",(0,o.mdx)("inlineCode",{parentName:"li"},"{ products: Product[] }")),(0,o.mdx)("li",{parentName:"ul"},"GET:",(0,o.mdx)("inlineCode",{parentName:"li"},"/api/products/:id"),(0,o.mdx)("br",null),"\nRetournera le produit avec le",(0,o.mdx)("inlineCode",{parentName:"li"},"_id"),"\xa0fourni sous la forme\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"{ product: Product }")),(0,o.mdx)("li",{parentName:"ul"},"POST:",(0,o.mdx)("inlineCode",{parentName:"li"},"/api/products"),(0,o.mdx)("br",null),"\nCr\xe9era un nouveau Product dans la base de donn\xe9es.",(0,o.mdx)("br",null),"\nLe corps de la requ\xeate\xa0a pour forme :")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "name": string,\n    "description": string,\n    "price": number,\n    "inStock": boolean\n}\n')),(0,o.mdx)("p",null,"Il retournera le Product ainsi cr\xe9\xe9 (y compris son champ\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"_id"),"),\xa0sous la forme ",(0,o.mdx)("inlineCode",{parentName:"p"},"{ product: Product }"),"."),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"La Promise retourn\xe9e par la m\xe9thode\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"save()"),"\xa0de votre mod\xe8le\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"Mongoose"),"\xa0re\xe7oit le produit cr\xe9\xe9 :"),(0,o.mdx)("pre",{parentName:"div"},(0,o.mdx)("code",{parentName:"pre",className:"language-javascript"},"product.save()\n    .then(product => ... ... .json({ product }))\n    .catch(error => ... ...)\n")))),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"PUT:\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"/api/products/:id"),(0,o.mdx)("br",null),"\nModifiera le produit avec le\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"_id"),"\xa0fourni selon les donn\xe9es envoy\xe9es dans le corps de la requ\xeate.",(0,o.mdx)("br",null),"\nLe corps de la requ\xeate a pour\xa0forme :")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "name": string,\n    "description": string,\n    "price": number,\n    "inStock": boolean\n}\n')),(0,o.mdx)("p",null,"Retournera un objet de la forme ",(0,o.mdx)("inlineCode",{parentName:"p"},"{ message: 'Modified!' }")),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"DELETE :\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"/api/products/:id"),(0,o.mdx)("br",null),"\nSupprimera le produit avec le\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"_id"),"\xa0fourni.",(0,o.mdx)("br",null),"\nRetournera un objet de la forme\xa0",(0,o.mdx)("inlineCode",{parentName:"li"},"{ message: 'Deleted!' }"))),(0,o.mdx)("p",null,"Votre API devra tourner sur votre machine locale en\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"localhost"),"\xa0(de pr\xe9f\xe9rence en port 3000, mais l'application front-end vous permet de modifier ce\nport si besoin) et accepter les requ\xeates HTTP venant de n'importe quelle origine (n'oubliez pas la configuration CORS !)."),(0,o.mdx)("p",null,"Pour tester votre API, vous allez installer une mini-application front-end. Clonez ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/OpenClassrooms-Student-Center/fullstack-activity"},"le repo avec le code frontend\xa0sur ce lien"),"."),(0,o.mdx)("p",null,"Depuis le dossier clon\xe9, ex\xe9cutez\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"npm install"),"\xa0puis\xa0",(0,o.mdx)("inlineCode",{parentName:"p"},"npm start"),". Vous devriez voir s'ouvrir une fen\xeatre de navigateur comme celle-ci :"),(0,o.mdx)("figure",null,(0,o.mdx)("img",{src:"https://user.oc-static.com/upload/2019/10/22/15717373055881_Screenshot%202019-10-22%20at%2011.41.36.png",alt:"Front end app"}),(0,o.mdx)("figcaption",null,"Application front-end")),(0,o.mdx)("p",null,"Si votre serveur tourne, cliquez sur ",(0,o.mdx)("kbd",null,"TEST ROUTES")," pour lancer les tests. Ces tests vous permettront de v\xe9rifier que vous avez\nbien r\xe9ussi \xe0 impl\xe9menter les routes demand\xe9es et donc de valider ce quiz ! Vous verrez appara\xeetre des messages de succ\xe8s (ou d'erreur) selon que\nl'application a r\xe9ussi \xe0 faire fonctionner votre API ou non."),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("p",{parentName:"div"},"Si votre navigateur s'ouvre avec une erreur 404, attendez quelques secondes et faites un ",(0,o.mdx)("em",{parentName:"p"},"refresh"),"."),(0,o.mdx)("p",{parentName:"div"},"Parfois, lors de la premi\xe8re tentative apr\xe8s le lancement de l'application, celle-ci \xe9met une erreur m\xeame si l'API fonctionne. Re-cliquez sur ",(0,o.mdx)("kbd",null,"TEST\nROUTES"),". S'il y a toujours une erreur, il est probable qu'elle vienne de votre API."))),(0,o.mdx)("hr",null),(0,o.mdx)("h4",{id:"question-1--quand-tout-fonctionnera-bien-lapplication-de-test-affichera-un-mot-secret-quel-est-ce-mot-secret--s\xe9lectionnez-le-dans-la-liste-ci-dessous-"},"Question 1 : Quand tout fonctionnera bien, l'application de test affichera un mot secret. Quel est ce mot secret ? S\xe9lectionnez-le dans la liste ci-dessous :"),(0,o.mdx)("i",{class:"bi bi-circle"})," GIRAFFE",(0,o.mdx)("br",null),(0,o.mdx)("i",{class:"bi bi-circle"})," ELEPHANT",(0,o.mdx)("br",null),(0,o.mdx)("i",{class:"bi bi-record-circle"})," GORILLA",(0,o.mdx)("br",null),(0,o.mdx)("i",{class:"bi bi-circle"})," ZEBRA",(0,o.mdx)("br",null),(0,o.mdx)("hr",null),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-json",metastring:'title="package.json"',title:'"package.json"'},'{\n    "name": "backend-activity",\n    "version": "1.0.0",\n    "main": "server.js",\n    "scripts": {\n        "test": "echo \\"Error: no test specified\\" && exit 1"\n    },\n    "author": "",\n    "license": "ISC",\n    "dependencies": {\n        "body-parser": "^1.19.0",\n        "express": "^4.17.1",\n        "mongoose": "^6.0.12",\n        "nodemon": "^2.0.14"\n    },\n    "description": ""\n}\n')),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript",metastring:'title="models/Product.js"',title:'"models/Product.js"'},"const mongoose = require('mongoose');\n\nconst productSchema = mongoose.Schema({\n    name: { type: String, required: true },\n    description: { type: String, required: true },\n    price: { type: Number, required: true },\n    inStock: { type: Boolean, required: true }\n});\n\nmodule.exports = mongoose.model('Product', productSchema);\n")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript",metastring:'title="server.js"',title:'"server.js"'},"const http = require('http');\nconst app = require('./app');\n\nconst normalizePort = val => {\n    const port = parseInt(val, 10);\n\n    if (isNaN(port)) {\n        return val;\n    }\n    if (port >= 0) {\n        return port;\n    }\n    return false;\n};\nconst port = normalizePort(process.env.PORT || '3006');\napp.set('port', port);\n\nconst errorHandler = error => {\n    if (error.syscall !== 'listen') {\n        throw error;\n    }\n    const address = server.address();\n    const bind = typeof address === 'string' ? 'pipe ' + address : 'port: ' + port;\n    switch (error.code) {\n        case 'EACCES':\n            console.error(bind + ' requires elevated privileges.');\n            process.exit(1);\n            break;\n        case 'EADDRINUSE':\n            console.error(bind + ' is already in use.');\n            process.exit(1);\n            break;\n        default:\n            throw error;\n    }\n};\n\nconst server = http.createServer(app);\n\nserver.on('error', errorHandler);\nserver.on('listening', () => {\n    const address = server.address();\n    const bind = typeof address === 'string' ? 'pipe ' + address : 'port ' + port;\n    console.log('Listening on ' + bind);\n});\n\nserver.listen(port);\n")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-javascript",metastring:'title="app.js"',title:'"app.js"'},"const express = require('express');\nconst bodyParser = require('body-parser');\nconst mongoose = require('mongoose');\n\nconst Product = require('./models/Product');\n\nmongoose.connect('mongodb+srv://gylgyl2000:Merlin2004@cluster0.2gtcx.mongodb.net/myFirstDatabase?retryWrites=true&w=majority',\n    { useNewUrlParser: true,\n      useUnifiedTopology: true })\n    .then(() => console.log('Connexion \xe0 MongoDB r\xe9ussie !'))\n    .catch(() => console.log('Connexion \xe0 MongoDB \xe9chou\xe9e !'));\n\nconst app = express();\n\napp.use((req, res, next) => {\n    res.setHeader('Access-Control-Allow-Origin', '*');\n    res.setHeader('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content, Accept, Content-Type, Authorization');\n    res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, PATCH, OPTIONS');\n    next();\n});\n\napp.use(bodyParser.json());\n\napp.post('/api/products', (req, res, next) => {\n    const product = new Product({\n        ...req.body\n    });\n    product.save()\n    .then(product => res.status(201).json({ product}))\n    .catch(error => res.status(400).json({ error }));\n});\n\napp.get('/api/products/:id', (req, res, next) => {\n    Product.findOne({ _id: req.params.id })\n    .then(product => res.status(200).json({ product }))\n    .catch(error => res.status(404).json({ error }));\n});\n\napp.get('/api/products', (req, res, next) => {\n    Product.find()\n        .then(products => res.status(200).json({ products }))\n        .catch(error => res.status(400).json({ error }));\n});\n\napp.put('/api/products/:id', (req, res, next) => {\n    Product.updateOne({ _id: req.params.id }, { ...req.body, _id: req.params.id })\n    .then(product => res.status(200).json({ message: 'Modified!' }))\n    .catch(error => res.status(404).json({ error }));\n});\n\napp.delete('/api/products/:id', (req, res, next) => {\n    Product.deleteOne({ _id: req.params.id })\n      .then(() => res.status(200).json({ message: 'Deleted!' }))\n      .catch(error => res.status(404).json({ error }))\n});\n\nmodule.exports = app;\n")),(0,o.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,o.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,o.mdx)("h5",{parentName:"div"},(0,o.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,o.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Installation et d\xe9marrage")),(0,o.mdx)("div",{parentName:"div",className:"admonition-content"},(0,o.mdx)("pre",{parentName:"div"},(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"npm install -g @angular/cli\n")),(0,o.mdx)("pre",{parentName:"div"},(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"git clone https://github.com/OpenClassrooms-Student-Center/fullstack-activity frontend\n")),(0,o.mdx)("pre",{parentName:"div"},(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"cd frontend\nnpm install\nnpm install --save-dev run-script-os\nnpm run start\n")),(0,o.mdx)("p",{parentName:"div"},"http://localhost:8081"),(0,o.mdx)("pre",{parentName:"div"},(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"cd backend\nnpm init\n=> entry point: (index.js) server.js\nnpm install -g nodemon\nnpm install --save express\nnpm install --save body-parser\nnpm install --save mongoose\nnodemon server\n")))))}c.isMDXComponent=!0}}]);