"use strict";(self.webpackChunkmon_web_dev_wiki=self.webpackChunkmon_web_dev_wiki||[]).push([[3061],{38949:function(e,n,a){a.r(n),a.d(n,{frontMatter:function(){return l},contentTitle:function(){return u},metadata:function(){return m},toc:function(){return d},default:function(){return c}});var t=a(83117),r=a(80102),i=(a(67294),a(3905)),s=(a(26396),a(58215),a(56222)),o=["components"],l={id:"2-Communiquez_via_une_API_avec_un_service_web",title:"Communiquez via une API avec un service web"},u="Communiquez via une API avec un service web",m={unversionedId:"OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web",id:"OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web",title:"Communiquez via une API avec un service web",description:"Comprenez ce que sont des API et un service web",source:"@site/docs/OpenClassrooms/5-Construisez_un_site_e-commerce/3-Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web.mdx",sourceDirName:"OpenClassrooms/5-Construisez_un_site_e-commerce/3-Ecrivez_du_JavaScript_pour_le_web",slug:"/OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web",editUrl:"https://github.com/gylgyl2000/Mon_Web_Dev_Wiki/edit/master/website/docs/OpenClassrooms/5-Construisez_un_site_e-commerce/3-Ecrivez_du_JavaScript_pour_le_web/2-Communiquez_via_une_API_avec_un_service_web.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"2-Communiquez_via_une_API_avec_un_service_web",title:"Communiquez via une API avec un service web"},sidebar:"openClassroomsSidebar",previous:{title:"Manipulez le DOM",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/1-Manipulez_le_DOM"},next:{title:"Parall\xe9lisez vos longues t\xe2ches avec la programmation asynchrone",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Construisez_un_site_e-commerce/Ecrivez_du_JavaScript_pour_le_web/3-Parallelisez_vos_longues_taches_avec_la_programmation_asynchrone"}},d=[{value:"Comprenez ce que sont des API et un service web",id:"comprenez-ce-que-sont-des-api-et-un-service-web",children:[{value:"Qu&#39;est-ce qu&#39;un service web ?",id:"quest-ce-quun-service-web-",children:[],level:4},{value:"Qu\u2019est-ce qu\u2019une API ?",id:"quest-ce-quune-api-",children:[],level:4},{value:"Qu&#39;est-ce que le protocole HTTP ?",id:"quest-ce-que-le-protocole-http-",children:[],level:4},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9",children:[],level:3}],level:2},{value:"R\xe9cup\xe9rez des donn\xe9es d&#39;un service web",id:"r\xe9cup\xe9rez-des-donn\xe9es-dun-service-web",children:[{value:"Qu&#39;est-ce que Fetch ?",id:"quest-ce-que-fetch-",children:[],level:3},{value:"Envoyez une premi\xe8re requ\xeate",id:"envoyez-une-premi\xe8re-requ\xeate",children:[],level:3},{value:"R\xe9cup\xe9rez les donn\xe9es au format JSON",id:"r\xe9cup\xe9rez-les-donn\xe9es-au-format-json",children:[{value:"Qu&#39;est-ce que le format JSON ?",id:"quest-ce-que-le-format-json-",children:[],level:4},{value:"R\xe9cup\xe9rez le r\xe9sultat de la requ\xeate",id:"r\xe9cup\xe9rez-le-r\xe9sultat-de-la-requ\xeate",children:[],level:4}],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer-",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9-1",children:[],level:3}],level:2},{value:"Validez les donn\xe9es saisies par vos utilisateurs",id:"validez-les-donn\xe9es-saisies-par-vos-utilisateurs",children:[{value:"Never trust user input!",id:"never-trust-user-input",children:[],level:3},{value:"Validez les donn\xe9es suite \xe0 des \xe9v\xe9nements",id:"validez-les-donn\xe9es-suite-\xe0-des-\xe9v\xe9nements",children:[],level:3},{value:"Faites une validation plus complexe avec les Regex",id:"faites-une-validation-plus-complexe-avec-les-regex",children:[],level:3},{value:"D\xe9couvrez les contraintes HTML5",id:"d\xe9couvrez-les-contraintes-html5",children:[{value:"L&#39;attribut type pour les inputs",id:"lattribut-type-pour-les-inputs",children:[],level:4},{value:"Les attributs de validation simples",id:"les-attributs-de-validation-simples",children:[],level:4},{value:"Les patterns",id:"les-patterns",children:[],level:4}],level:3},{value:"\xc0 vous de jouer\xa0!",id:"\xe0-vous-de-jouer",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9-2",children:[],level:3}],level:2},{value:"Sauvegardez des donn\xe9es sur le service web",id:"sauvegardez-des-donn\xe9es-sur-le-service-web",children:[{value:"Envoyez des donn\xe9es, comment \xe7a marche ?",id:"envoyez-des-donn\xe9es-comment-\xe7a-marche-",children:[],level:3},{value:"Envoyez des donn\xe9es avec une requ\xeate POST",id:"envoyez-des-donn\xe9es-avec-une-requ\xeate-post",children:[],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--1",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9-3",children:[],level:3}],level:2},{value:"Quiz : Communiquez avec un service web",id:"quiz--communiquez-avec-un-service-web",children:[{value:"Comp\xe9tences \xe9valu\xe9es",id:"comp\xe9tences-\xe9valu\xe9es",children:[],level:4},{value:"Question 1 : Qu&#39;est-ce que le HTTP ?",id:"question-1--quest-ce-que-le-http-",children:[],level:4},{value:"Question 2 : Quel objet permet de cr\xe9er des requ\xeates HTTP en JavaScript ?",id:"question-2--quel-objet-permet-de-cr\xe9er-des-requ\xeates-http-en-javascript-",children:[],level:4},{value:"Question 3 : Qu&#39;est-ce que le JSON ?",id:"question-3--quest-ce-que-le-json-",children:[],level:4},{value:"Question 4 : Que fait cet extrait ?",id:"question-4--que-fait-cet-extrait-",children:[],level:4},{value:"Question 5 : Que fait cet extrait ?",id:"question-5--que-fait-cet-extrait-",children:[],level:4},{value:"Question 6 : Que va afficher cet extrait dans la console ?",id:"question-6--que-va-afficher-cet-extrait-dans-la-console-",children:[],level:4},{value:"Question 7 : Comment sera trait\xe9 ce champ ?",id:"question-7--comment-sera-trait\xe9-ce-champ-",children:[],level:4},{value:"Question 8 : Que fait cet extrait ?",id:"question-8--que-fait-cet-extrait-",children:[],level:4}],level:2}],p={toc:d};function c(e){var n=e.components,a=(0,r.Z)(e,o);return(0,i.mdx)("wrapper",(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"communiquez-via-une-api-avec-un-service-web"},"Communiquez via une API avec un service web"),(0,i.mdx)("h2",{id:"comprenez-ce-que-sont-des-api-et-un-service-web"},"Comprenez ce que sont des API et un service web"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/5543061-ecrivez-du-javascript-pour-le-web/5577576-comprenez-ce-que-sont-des-api-et-un-service-web"},"Comprenez ce que sont des API et un service web - \xc9crivez du JavaScript pour le web - OpenClassrooms")),(0,i.mdx)(s.fG,{vimeoId:"539127771",mdxType:"Vimeo"}),(0,i.mdx)("br",null),(0,i.mdx)("p",null,"Les services web et les API sont des \xe9l\xe9ments essentiels aux applications web. N\u2019importe quel site sur lequel vous naviguez est un service web,\net il fournit une API pour communiquer avec."),(0,i.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Mais qu\u2019est-ce que c\u2019est exactement ?"))),(0,i.mdx)("h4",{id:"quest-ce-quun-service-web-"},"Qu'est-ce qu'un service web ?"),(0,i.mdx)("p",null,"Un service web est un programme s'ex\xe9cutant sur un serveur accessible depuis Internet et fournissant un service."),(0,i.mdx)("p",null,"Par exemple, Google est un service web qui vous permet de rechercher des sites web. Une application m\xe9t\xe9o communique avec un service web qui\nfournit la m\xe9t\xe9o. Un r\xe9seau social est un service web qui permet de retrouver ses amis et de communiquer avec."),(0,i.mdx)("p",null,"Le but d\u2019un service web est donc de fournir un service \xe0 celui qui le demande. Et pour ce faire, il met \xe0 disposition une ",(0,i.mdx)("strong",{parentName:"p"},"API"),"."),(0,i.mdx)("h4",{id:"quest-ce-quune-api-"},"Qu\u2019est-ce qu\u2019une API ?"),(0,i.mdx)("p",null,"Une API, ou ",(0,i.mdx)("em",{parentName:"p"},"Application Programming Interface"),", est une interface de communication. Il en existe diff\xe9rents types, mais celle qui nous\nint\xe9resse est celle qui permet de communiquer avec les services web."),(0,i.mdx)("p",null,"L\u2019API correspond \xe0 l\u2019ensemble des demandes que l\u2019on peut faire \xe0 un service web. Ces demandes sont appel\xe9es des ",(0,i.mdx)("strong",{parentName:"p"},"requ\xeates"),"."),(0,i.mdx)("p",null,"Par exemple, demander la m\xe9t\xe9o actuelle est une requ\xeate. Faire une demande d\u2019ami sur un r\xe9seau social est une requ\xeate. Ou encore, envoyer un\nmessage via une application de messagerie est une requ\xeate."),(0,i.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Mais \xe0 quoi ressemble une requ\xeate ?"))),(0,i.mdx)("p",null,"C'est une question int\xe9ressante, mais aussi complexe. En effet, il a bien fallu se mettre d'accord sur le ",(0,i.mdx)("strong",{parentName:"p"},"langage")," \xe0 utiliser pour\ncommuniquer via les API. Mais voil\xe0, un service d'envoi de mails ne fait pas du tout le m\xeame travail qu'un service nous renvoyant les pages\nd'un site Internet. Il semble donc \xe9vident que la mani\xe8re de communiquer ne sera pas la m\xeame pour ces deux services. Des ",(0,i.mdx)("strong",{parentName:"p"},"protocoles de\ncommunication")," ont donc \xe9t\xe9 mis en place afin de standardiser la communication entre services faisant la m\xeame chose."),(0,i.mdx)("p",null,"Les ",(0,i.mdx)("strong",{parentName:"p"},"requ\xeates")," sont des donn\xe9es qui respectent le protocole de communication et qui sont envoy\xe9es au serveur."),(0,i.mdx)("p",null,"Nous avons donc un protocole pour l'envoi de mail (",(0,i.mdx)("em",{parentName:"p"},"SMTP"),"), la r\xe9ception de mail (",(0,i.mdx)("em",{parentName:"p"},"IMAP"),"), les requ\xeates li\xe9es \xe0 des ressources web (",(0,i.mdx)("em",{parentName:"p"},"HTTP),"),"\naux transferts de fichiers (",(0,i.mdx)("em",{parentName:"p"},"FTP"),"), etc."),(0,i.mdx)("p",null,"Le protocole qui va nous int\xe9resser est le protocole nous permettant de communiquer avec l\u2019API d\u2019un site Internet : le protocole ",(0,i.mdx)("strong",{parentName:"p"},"HTTP"),".\nGr\xe2ce \xe0 lui, nous allons pouvoir r\xe9cup\xe9rer et sauvegarder des donn\xe9es sur un service web, ce qui nous permettra de dynamiser le contenu de nos\npages web."),(0,i.mdx)("h4",{id:"quest-ce-que-le-protocole-http-"},"Qu'est-ce que le protocole HTTP ?"),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},(0,i.mdx)("em",{parentName:"strong"},"HTTP"))," signifie ",(0,i.mdx)("em",{parentName:"p"},"HyperText Transfer Protocol.")," C'est un protocole qui permet de ",(0,i.mdx)("strong",{parentName:"p"},"communiquer")," avec un site Internet. Il va permettre de\ncharger des ",(0,i.mdx)("strong",{parentName:"p"},"pages HTML"),", des ",(0,i.mdx)("strong",{parentName:"p"},"styles CSS"),", des ",(0,i.mdx)("strong",{parentName:"p"},"polices de caract\xe8res"),", des ",(0,i.mdx)("strong",{parentName:"p"},"images"),", etc. Mais ce n'est pas tout, le protocole HTTP\nnous permet aussi d'envoyer des formulaires et de r\xe9cup\xe9rer et d'envoyer toutes sortes de donn\xe9es depuis ou vers un serveur impl\xe9mentant ce\nprotocole gr\xe2ce \xe0 son API !"),(0,i.mdx)("p",null,"Nous n'allons pas entrer dans le d\xe9tail du format des requ\xeates HTTP",(0,i.mdx)("em",{parentName:"p"},",")," car ",(0,i.mdx)("a",{parentName:"p",href:"https://www.google.fr/search?q=http"},"de nombreuses r\xe9f\xe9rences")," le\nfont d\xe9j\xe0 tr\xe8s bien. Tout ce que vous avez besoin de savoir c\u2019est que plusieurs informations se trouvent dans une requ\xeate HTTP :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"La m\xe9thode"),". Il s\u2019agit de l\u2019action que l\u2019on souhaite faire : r\xe9cup\xe9rer une ressource, la supprimer, etc. Voici les m\xe9thodes HTTP les plus\ncourantes :",(0,i.mdx)("ul",{parentName:"li"},(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"GET")," : permet de ",(0,i.mdx)("strong",{parentName:"li"},"r\xe9cup\xe9rer")," des ressources, comme par exemple le temps actuel sur un service de m\xe9t\xe9o ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"POST")," : permet de ",(0,i.mdx)("strong",{parentName:"li"},"cr\xe9er")," ou ",(0,i.mdx)("strong",{parentName:"li"},"modifier")," une ressource, comme la cr\xe9ation d'un nouvel utilisateur sur votre application ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"PUT")," : permet de ",(0,i.mdx)("strong",{parentName:"li"},"modifier")," une ressource, comme le nom de l'utilisateur que vous venez de cr\xe9er avec ",(0,i.mdx)("em",{parentName:"li"},"POST")," ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"DELETE")," : Permet de ",(0,i.mdx)("strong",{parentName:"li"},"supprimer")," une ressource, comme un commentaire dans un fil de discussion."))),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"L\u2019URL"),". C\u2019est l\u2019adresse sur le service web que vous souhaitez atteindre. Un peu comme un identifiant unique afin que le web service\ncomprenne ce que vous voulez."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Les donn\xe9es"),". Lorsqu\u2019on fait une requ\xeate pour enregistrer des donn\xe9es (par exemple un formulaire) il faut pouvoir envoyer ces donn\xe9es au\nservice web.")),(0,i.mdx)("p",null,"Une fois votre requ\xeate envoy\xe9e et trait\xe9e par le service web, celui-ci va vous r\xe9pondre avec, entre autres, les informations suivantes :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Les donn\xe9es"),". Les donn\xe9es que vous avez demand\xe9es : une page HTML, etc."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Le code HTTP"),". Il s\u2019agit d\u2019un code num\xe9rique qui vous indique comment s\u2019est d\xe9roul\xe9e la requ\xeate. Voici les plus courants :",(0,i.mdx)("ul",{parentName:"li"},(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"200")," : indique que tout s\u2019est bien pass\xe9"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"400")," : indique que votre requ\xeate n\u2019est pas conforme \xe0 ce qui est attendu"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"401")," : indique que vous devez \xeatre authentifi\xe9 pour faire cette requ\xeate"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"403")," : indique que vous \xeates bien authentifi\xe9 mais que vous n\u2019\xeates pas autoris\xe9 \xe0 faire cette requ\xeate"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"404")," : indique que la ressource demand\xe9e n\u2019existe pas"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"500")," : indique une erreur avec le service web"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("a",{parentName:"li",href:"https://fr.wikipedia.org/wiki/Liste_des_codes_HTTP"},"Voici une liste exhaustive des codes HTTPs"))))),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Il s'agit surtout d'une convention. Rien n'oblige un service web \xe0 cr\xe9er une ressource lors d'une requ\xeate ",(0,i.mdx)("em",{parentName:"p"},"POST"),"\xa0 par exemple, mais c'est\ng\xe9n\xe9ralement le cas."))),(0,i.mdx)("h3",{id:"en-r\xe9sum\xe9"},"En r\xe9sum\xe9"),(0,i.mdx)("p",null,"Dans ce chapitre, vous avez appris :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Qu\u2019un service web est une application sur internet qui r\xe9pond \xe0 un besoin : Google qui permet de faire des recherches, Facebook qui permet de\ngarder contact avec ses amis, etc. ;"),(0,i.mdx)("li",{parentName:"ul"},"Qu\u2019une API est une interface de communication entre un service web et le navigateur;"),(0,i.mdx)("li",{parentName:"ul"},"Qu\u2019un protocole de communication permet de d\xe9finir comment communiquer avec un service. Comme la d\xe9finition des normes, que tout le monde\npeut utiliser."),(0,i.mdx)("li",{parentName:"ul"},"Que le protocole HTTP est le protocole de communication utilis\xe9 par les services web.")),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Avec ce que vous venez d'apprendre, vous \xeates maintenant en mesure de communiquer avec un service web. Il ne vous reste plus qu'\xe0 savoir\ncomment on fait \xe7a en JavaScript, et c'est justement ce que nous allons voir dans le chapitre suivant !")),(0,i.mdx)("hr",null),(0,i.mdx)("h2",{id:"r\xe9cup\xe9rez-des-donn\xe9es-dun-service-web"},"R\xe9cup\xe9rez des donn\xe9es d'un service web"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/5543061-ecrivez-du-javascript-pour-le-web/5577591-recuperez-des-donnees-dun-service-web"},"R\xe9cup\xe9rez des donn\xe9es d'un service web - \xc9crivez du JavaScript pour le web - OpenClassrooms")),(0,i.mdx)(s.fG,{vimeoId:"539127809",mdxType:"Vimeo"}),(0,i.mdx)("br",null),(0,i.mdx)("p",null,"Maintenant que nous savons ce qu'est une ",(0,i.mdx)("strong",{parentName:"p"},"requ\xeate HTTP"),", il ne nous reste plus qu'\xe0 apprendre \xe0 en cr\xe9er une en JavaScript pour r\xe9cup\xe9rer des\ndonn\xe9es, comme la m\xe9t\xe9o. C'est l\xe0 que l\u2019API ",(0,i.mdx)("strong",{parentName:"p"},"Fetch")," entre en jeu !"),(0,i.mdx)("h3",{id:"quest-ce-que-fetch-"},"Qu'est-ce que Fetch ?"),(0,i.mdx)("p",null,"Fetch est un\xa0",(0,i.mdx)("strong",{parentName:"p"},"ensemble d'objets et de fonctions")," mis \xe0 disposition par le langage JavaScript, afin d'ex\xe9cuter des requ\xeates HTTP de mani\xe8re\nasynchrone."),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Nous verrons en d\xe9tail ce qu'",(0,i.mdx)("em",{parentName:"p"},"asynchrone")," signifie dans la prochaine partie, retenez simplement pour l\u2019instant que cela permet d'ex\xe9cuter du\ncode (une requ\xeate ici), sans bloquer l'ex\xe9cution de la page, en attendant la r\xe9ponse du service web."))),(0,i.mdx)("p",null,"L\u2019API Fetch\xa0 va nous permettre d'ex\xe9cuter des requ\xeates HTTP sans avoir besoin de recharger la page du navigateur. Cela a plusieurs avantages :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Avoir un site plus r\xe9actif")," car on n'a pas besoin de recharger toute la page d\xe8s qu'on a besoin de mettre \xe0 jour une partie du contenu ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Am\xe9liorer l'exp\xe9rience utilisateur")," avec du nouveau contenu qui se charge au fur et \xe0 mesure qu'on le d\xe9couvre, par exemple.")),(0,i.mdx)("h3",{id:"envoyez-une-premi\xe8re-requ\xeate"},"Envoyez une premi\xe8re requ\xeate"),(0,i.mdx)("p",null,"Voyons maintenant comment on peut construire et envoyer une requ\xeate HTTP."),(0,i.mdx)("p",null,"Si vous vous souvenez du chapitre pr\xe9c\xe9dent, vous devez avoir devin\xe9 que nous allons cr\xe9er une requ\xeate HTTP avec la m\xe9thode GET, afin de\nr\xe9cup\xe9rer des donn\xe9es. C'est parti !"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'fetch("http://url-service-web.com/api/users");\n')),(0,i.mdx)("p",null,"Ce code nous permet d'envoyer une requ\xeate HTTP de type\xa0",(0,i.mdx)("em",{parentName:"p"},"GET")," au service web se trouvant \xe0 l'adresse ",(0,i.mdx)("inlineCode",{parentName:"p"},"http://url-service-web.com/api/users"),"."),(0,i.mdx)("h3",{id:"r\xe9cup\xe9rez-les-donn\xe9es-au-format-json"},"R\xe9cup\xe9rez les donn\xe9es au format JSON"),(0,i.mdx)("p",null,"Maintenant que nous savons comment construire et envoyer une requ\xeate HTTP, il faut r\xe9cup\xe9rer et interpr\xe9ter son r\xe9sultat."),(0,i.mdx)("p",null,"Un service web peut choisir le format qu'il veut pour nous renvoyer des donn\xe9es, mais le plus courant et le plus simple est le ",(0,i.mdx)("strong",{parentName:"p"},"format\xa0",(0,i.mdx)("em",{parentName:"strong"},"JSON")),"."),(0,i.mdx)("h4",{id:"quest-ce-que-le-format-json-"},"Qu'est-ce que le format JSON ?"),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"JSON")," signifie\xa0",(0,i.mdx)("em",{parentName:"p"},"JavaScript Object Notation"),". Il s'agit d'un ",(0,i.mdx)("strong",{parentName:"p"},"format textuel")," (contrairement \xe0 un format binaire plus l\xe9ger mais impossible \xe0\nlire \xe0 l'\u0153il humain), se rapprochant en termes de syntaxe de celui des objets dans le langage JavaScript."),(0,i.mdx)("p",null,"Ainsi, l'objet JavaScript suivant :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'const obj = {\n    name: "Mon contenu",\n    id: 1234,\n    message: "Voici mon contenu",\n    author: {\n        name: "John"\n    },\n    comments: [\n        {\n            id: 45,\n            message: "Commentaire 1"\n        },\n        {\n            id: 46,\n            message: "Commentaire 2"\n        }\n    ]\n};\n')),(0,i.mdx)("p",null,"sera retranscrit\xa0ainsi en JSON :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "Mon contenu",\n    "id": 1234,\n    "message": "Voici mon contenu",\n    "author": {\n        "name": "John"\n    },\n    "comments": [\n        {\n            "id": 45,\n            "message": "Commentaire 1"\n        },\n        {\n            "id": 46,\n            "message": "Commentaire 2"\n        }\n    ]\n}\n')),(0,i.mdx)("p",null,"Vous pouvez voir comme la syntaxe est similaire entre les 2. Alors qu'en JavaScript il n'est pas n\xe9cessaire de mettre les propri\xe9t\xe9s (comme\n",(0,i.mdx)("inlineCode",{parentName:"p"},"name"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"id"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"message"),", etc.), entre guillemets,\xa0cela l'est en JSON. En JavaScript, votre objet est assign\xe9 \xe0 une variable, alors qu'en JSON\non ne fait que d\xe9crire une structure."),(0,i.mdx)("p",null,"Le gros avantage de ce format lorsqu'il est utilis\xe9 avec le langage JavaScript est qu'il n'y a pas besoin de le\xa0",(0,i.mdx)("em",{parentName:"p"},(0,i.mdx)("strong",{parentName:"em"},"parser"))," comme on le ferait\navec du\xa0",(0,i.mdx)("em",{parentName:"p"},"XML")," par exemple. En effet, lorsque l'on manipule un format de donn\xe9es comme le\xa0",(0,i.mdx)("em",{parentName:"p"},"XML"),", (que vous pouvez comparer \xe0 du HTML dans sa\nforme) il est n\xe9cessaire de le\xa0",(0,i.mdx)("em",{parentName:"p"},"parser"),". C'est-\xe0-dire que notre application doit le ",(0,i.mdx)("strong",{parentName:"p"},"lire")," et le ",(0,i.mdx)("strong",{parentName:"p"},"comprendre")," afin d'en faire ce qu'on veut.\nC'est une op\xe9ration g\xe9n\xe9ralement complexe que l'on laisse \xe0 du code externe d\xe9velopp\xe9 et \xe9prouv\xe9 par d'autres personnes, afin de gagner du\ntemps et d'\xe9viter les erreurs. Mais pour le JSON c'est diff\xe9rent, car c'est une syntaxe qui vient des ",(0,i.mdx)("strong",{parentName:"p"},"objets en JavaScript"),". Ainsi, votre\nnavigateur sait directement le lire et le transformer en objets JavaScript. Si l'on reprend l'exemple de JSON\xa0pr\xe9c\xe9dent, il nous fournira donc\nun objet JavaScript comme celui du premier \xe9chantillon de code ci-dessus."),(0,i.mdx)("p",null,"Le deuxi\xe8me avantage de ce format est sa ",(0,i.mdx)("strong",{parentName:"p"},"l\xe9g\xe8ret\xe9")," par rapport \xe0 un format comme le\xa0",(0,i.mdx)("em",{parentName:"p"},"XML,")," qui reste bien plus verbeux, c'est-\xe0-dire avec\nplus de texte. C'est un gros avantage lorsqu'on communique avec un service web, car cela permet d'optimiser les temps de r\xe9ponse. En effet, un\nnombre plus faible d'octets a besoin de transiter dans le r\xe9seau."),(0,i.mdx)("h4",{id:"r\xe9cup\xe9rez-le-r\xe9sultat-de-la-requ\xeate"},"R\xe9cup\xe9rez le r\xe9sultat de la requ\xeate"),(0,i.mdx)("p",null,"Avec tout ce que l'on vient d'apprendre, il n'est plus tr\xe8s difficile d'utiliser le r\xe9sultat de la requ\xeate pour en faire ce que l'on veut. Pour\ncela Fetch va nous renvoyer une ",(0,i.mdx)("strong",{parentName:"p"},"Promise"),"."),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Pour faire simple : la ",(0,i.mdx)("em",{parentName:"p"},"Promise")," est un objet qui fournit une fonction ",(0,i.mdx)("em",{parentName:"p"},"then")," qui sera ex\xe9cut\xe9e quand le r\xe9sultat aura \xe9t\xe9 obtenu, et une\nfonction ",(0,i.mdx)("em",{parentName:"p"},"catch")," qui sera appel\xe9e s\u2019il y a une erreur qui est survenue lors de la requ\xeate (Nous verrons tout cela plus en d\xe9tail dans la partie\n3)."))),(0,i.mdx)("p",null,"Voici comment proc\xe9der avec un service qui fait un simple echo :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'fetch("https://mockbin.com/request")\n    .then(function(res) {\n        if (res.ok) {\n            return res.json();\n        }\n    })\n    .then(function(value) {\n        console.log(value);\n    })\n    .catch(function(err) {\n        // Une erreur est survenue\n    });\n')),(0,i.mdx)("p",null,"Vous pouvez voir dans l'exemple ci-dessus que l'URL pass\xe9e \xe0 la fonction ",(0,i.mdx)("inlineCode",{parentName:"p"},"fetch()"),"\xa0a chang\xe9 et correspond \xe0 l\u2019URL de notre service web. Le type\nde requ\xeate est GET (ce qui est le cas par d\xe9faut avec ",(0,i.mdx)("em",{parentName:"p"},"Fetch"),") car nous voulons r\xe9cup\xe9rer les donn\xe9es."),(0,i.mdx)("p",null,"Ensuite nous appelons la fonction ",(0,i.mdx)("inlineCode",{parentName:"p"},"then()")," pour r\xe9cup\xe9rer le r\xe9sultat de la requ\xeate au format ",(0,i.mdx)("em",{parentName:"p"},"json")," en ayant v\xe9rifi\xe9 au pr\xe9alable que la\nrequ\xeate s\u2019\xe9tait bien pass\xe9e avec ",(0,i.mdx)("inlineCode",{parentName:"p"},"res.ok"),". Ce r\xe9sultat ",(0,i.mdx)("em",{parentName:"p"},"json")," \xe9tant lui aussi une ",(0,i.mdx)("em",{parentName:"p"},"Promise"),", nous le retournons et r\xe9cup\xe9rons sa vraie valeur\ndans la fonction ",(0,i.mdx)("inlineCode",{parentName:"p"},"then()")," suivante."),(0,i.mdx)("p",null,"Voici ce que nous obtenons de l\u2019API \xe0 l\u2019heure o\xf9 j\u2019\xe9cris ces lignes :"),(0,i.mdx)("figure",null,(0,i.mdx)("img",{src:"https://user.oc-static.com/upload/2021/04/04/16175573146865_image8.png",alt:"Un extrait JSON de la r\xe9ponse \xe0 la requ\xeate"}),(0,i.mdx)("figcaption",null,"Extrait JSON")),(0,i.mdx)("h3",{id:"\xe0-vous-de-jouer-"},"\xc0 vous de jouer !"),(0,i.mdx)("p",null,(0,i.mdx)("img",{parentName:"p",src:"https://user.oc-static.com/upload/2021/04/20/16189267631776_A-vous-de-jouer%20%282%29.png",alt:"16189267631776_A-vous-de-jouer%20%282%29.png"})),(0,i.mdx)("p",null,"Exercez-vous maintenant avec ce que nous venons d'apprendre."),(0,i.mdx)("p",null,"Rendez-vous dans ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/fabienhenon/pen/vYxYjpJ"},"cet \xe9diteur CodePen")," pour r\xe9aliser l'exercice suivant :\nDans cet exercice nous voulons r\xe9cup\xe9rer les salutations et les afficher d\xe8s que nous cliquons sur le bouton ",(0,i.mdx)("em",{parentName:"p"},'"Bien le bonjour"')),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Etape 1")," : Nous allons commencer par la cr\xe9ation d'une fonction ",(0,i.mdx)("inlineCode",{parentName:"li"},"askHello"),"\xa0qui va cr\xe9er une requ\xeate avec fetch de type ",(0,i.mdx)("inlineCode",{parentName:"li"},"GET"),"\xa0vers le\nservice web avec l'URL ",(0,i.mdx)("inlineCode",{parentName:"li"},"https://mockbin.com/request?greetings=salut.")),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Etape 2")," : Maintenant, nous voudrions r\xe9cup\xe9rer la r\xe9ponse du service web et l'afficher dans l'\xe9l\xe9ment ayant pour ID ",(0,i.mdx)("inlineCode",{parentName:"li"},"hello-result"),".\nModifiez donc notre fonction ",(0,i.mdx)("inlineCode",{parentName:"li"},"askHello"),"\xa0afin de r\xe9cup\xe9rer la r\xe9ponse du service web d\xe8s que tout s'est bien pass\xe9. Le service web vous\nretournera une r\xe9ponse au format JSON, et vous aurez besoin d'afficher la propri\xe9t\xe9 greetings se trouvant dans l'objet ",(0,i.mdx)("inlineCode",{parentName:"li"},"queryString"),".")),(0,i.mdx)("p",null,"Voici \xe0 quoi ressemble la r\xe9ponse JSON :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "queryString": {\n        "greetings": "Salut",\n        ...\n    },\n    ...\n}\n')),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("strong",{parentName:"li"},"Etape 3")," : Enfin, nous voulons afficher la salutation (et donc appeler notre fonction ",(0,i.mdx)("inlineCode",{parentName:"li"},"askHello"),") d\xe8s que nous cliquons sur le bouton\nayant pour ID ",(0,i.mdx)("inlineCode",{parentName:"li"},"ask-hello"),".")),(0,i.mdx)(s.sp,{codePenId:"vYxYjpJ",mdxType:"CodePen"}),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'function askHello() {\n  fetch("https://mockbin.com/request?greetings=salut")\n  .then(function(res) {\n    if (res.ok) {\n      return res.json();\n    }\n  })\n  .then(function(value) {\n    document\n        .getElementById("hello-result")\n        .innerText = value.queryString.greetings;\n  })\n  .catch(function(err) {\n    // Une erreur est survenue\n  });\n}\n\ndocument\n  .getElementById("ask-hello")\n  .addEventListener("click", askHello);\n')),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Vous avez essay\xe9 ? Voici la ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/fabienhenon/pen/RwovXJd"},"correction CodePen"),"."))),(0,i.mdx)(s.sp,{codePenId:"RwovXJd",mdxType:"CodePen"}),(0,i.mdx)("h3",{id:"en-r\xe9sum\xe9-1"},"En r\xe9sum\xe9"),(0,i.mdx)("p",null,"Dans ce chapitre, vous avez appris :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Que l\u2019API Fetch permet de faire des requ\xeates HTTP vers un service web ;"),(0,i.mdx)("li",{parentName:"ul"},"Comment l'utiliser pour faire une requ\xeate simple \xe0 un service web ;"),(0,i.mdx)("li",{parentName:"ul"},"Que le format JSON est tr\xe8s utilis\xe9 dans la communication avec les API des services web car il est tr\xe8s proche des objets JavaScript ;"),(0,i.mdx)("li",{parentName:"ul"},"Comment r\xe9cup\xe9rer les donn\xe9es envoy\xe9es par un service web.")),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Maintenant que nous savons faire une requ\xeate de type GET pour r\xe9cup\xe9rer des donn\xe9es du service web, nous allons voir comment faire une requ\xeate\nPOST pour envoyer des donn\xe9es au service web. Mais avant \xe7a, voyons comment pr\xe9parer nos donn\xe9es \xe0 \xeatre envoy\xe9es au service web.")),(0,i.mdx)("hr",null),(0,i.mdx)("h2",{id:"validez-les-donn\xe9es-saisies-par-vos-utilisateurs"},"Validez les donn\xe9es saisies par vos utilisateurs"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/5543061-ecrivez-du-javascript-pour-le-web/5577611-validez-les-donnees-saisies-par-vos-utilisateurs"},"Validez les donn\xe9es saisies par vos utilisateurs - \xc9crivez du JavaScript pour le web - OpenClassrooms")),(0,i.mdx)(s.fG,{vimeoId:"539127837",mdxType:"Vimeo"}),(0,i.mdx)("br",null),(0,i.mdx)("p",null,"Avant d'envoyer nos donn\xe9es \xe0 un service web, il est n\xe9cessaire de les ",(0,i.mdx)("strong",{parentName:"p"},"valider"),". C'est-\xe0-dire que nous allons v\xe9rifier leur ",(0,i.mdx)("strong",{parentName:"p"},"coh\xe9rence"),"\npar rapport \xe0 ce que le service web attend."),(0,i.mdx)("p",null,"Les donn\xe9es que l'on souhaite envoyer \xe0 un service web viennent g\xe9n\xe9ralement de ce que l'utilisateur saisit dans un formulaire ; or, ce n'est\npas parce que vous lui avez explicitement demand\xe9 d'entrer un num\xe9ro de t\xe9l\xe9phone qu'il va le faire..."),(0,i.mdx)("h3",{id:"never-trust-user-input"},"Never trust user input!"),(0,i.mdx)("p",null,"Ce qui se traduit litt\xe9ralement par :\xa0",(0,i.mdx)("strong",{parentName:"p"},"Ne faites jamais confiance aux donn\xe9es saisies par vos utilisateurs !")),(0,i.mdx)("p",null,"Il est bon de le rappeler :"),(0,i.mdx)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Ne faites jamais confiance \xe0 vos utilisateurs !"))),(0,i.mdx)("p",null,"Bon, maintenant je pense qu'il est temps d'expliquer pourquoi il faut \xeatre si m\xe9fiant envers vos utilisateurs, et pourquoi c'est si important."),(0,i.mdx)("p",null,"Certains de vos utilisateurs peuvent \xeatre ",(0,i.mdx)("strong",{parentName:"p"},"malveillants")," ou ils peuvent ",(0,i.mdx)("strong",{parentName:"p"},"ne pas bien comprendre")," ce que vous souhaitez qu'ils fassent. Bref,\nils ne vont pas toujours entrer les donn\xe9es que vous attendez d'eux. Or, cela peut se r\xe9v\xe9ler d\xe9sastreux pour votre site web, et ce, de\nplusieurs fa\xe7ons :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Si l'utilisateur ne comprend pas ce que vous attendez de lui, il peut entrer quelque chose qui ne vous convient pas. Votre service web ne\nfera pas ce qu'il faut et l'utilisateur ne comprendra pas pourquoi \xe7a ne marche pas. Vous risquez de ",(0,i.mdx)("strong",{parentName:"li"},"perdre")," cet utilisateur parce que vous\nn'avez pas valid\xe9 les donn\xe9es saisies et affich\xe9 un message d'erreur indiquant que les donn\xe9es ne sont pas celles attendues ;"),(0,i.mdx)("li",{parentName:"ul"},"Pire encore, l'utilisateur pourrait ",(0,i.mdx)("strong",{parentName:"li"},"attaquer")," votre service web en entrant des ",(0,i.mdx)("strong",{parentName:"li"},"donn\xe9es\xa0malveillantes")," dans un champ alors que vous\nattendiez simplement un nom, par exemple. Dans ce cas, il pourrait prendre le contr\xf4le de votre service web, collecter des donn\xe9es utilisateurs,\nse faire passer pour un administrateur, et j'en passe... (il existe des tonnes de ressources sur Internet donnant des exemples de ces types\nd'attaques. Si cela vous int\xe9resse, je vous encourage \xe0 faire quelques recherches) ;"),(0,i.mdx)("li",{parentName:"ul"},"De la m\xeame mani\xe8re, l'utilisateur pourrait ",(0,i.mdx)("strong",{parentName:"li"},"faire planter")," votre application s'il entrait du texte dans un champ o\xf9 vous attendiez un nombre.")),(0,i.mdx)("p",null,"Nous allons apprendre ici \xe0 valider les donn\xe9es utilisateur sur votre site web avant de les envoyer \xe0 votre service web. Cela\xa0constitue un\npremier rempart face aux probl\xe8mes cit\xe9s plus haut, m\xeame si ce n'est pas suffisant,\xa0",(0,i.mdx)("strong",{parentName:"p"},"il faudra toujours avoir une validation pouss\xe9e des\ndonn\xe9es utilisateurs sur le service web"),"."),(0,i.mdx)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"C'est important, car rien n'emp\xeachera un utilisateur malveillant d'utiliser un logiciel pour envoyer directement les requ\xeates HTTP malveillantes\n\xe0 votre service web. De cette mani\xe8re, elles ne passeront pas par la case validation c\xf4t\xe9 site web..."))),(0,i.mdx)("h3",{id:"validez-les-donn\xe9es-suite-\xe0-des-\xe9v\xe9nements"},"Validez les donn\xe9es suite \xe0 des \xe9v\xe9nements"),(0,i.mdx)("p",null,"Afin de valider les donn\xe9es utilisateurs, vous pouvez vous aider des \xe9v\xe9nements du\xa0",(0,i.mdx)("em",{parentName:"p"},"DOM"),". Ainsi, vous pouvez \xe9couter l'\xe9v\xe9nement\xa0",(0,i.mdx)("inlineCode",{parentName:"p"},"onChange")," pour\nv\xe9rifier la donn\xe9e, d\xe8s que l'utilisateur a fini de l'\xe9diter. Ou bien vous pouvez \xe9couter l'\xe9v\xe9nement ",(0,i.mdx)("inlineCode",{parentName:"p"},"onInput"),"\xa0pour v\xe9rifier la donn\xe9e \xe0 chaque\nnouveau caract\xe8re."),(0,i.mdx)("p",null,"Par exemple, vous pouvez v\xe9rifier que ce qui est saisi commence par ",(0,i.mdx)("inlineCode",{parentName:"p"},"Hello")," avec le code suivant :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"myInput.addEventListener('input', function(e) {\n    var value = e.target.value;\n    if (value.startsWith('Hello ')) {\n        isValid = true;\n    } else {\n        isValid = false;\n    }\n});\n")),(0,i.mdx)("h3",{id:"faites-une-validation-plus-complexe-avec-les-regex"},"Faites une validation plus complexe avec les Regex"),(0,i.mdx)("p",null,"Si vous n'avez jamais entendu parl\xe9 des ",(0,i.mdx)("em",{parentName:"p"},(0,i.mdx)("strong",{parentName:"em"},"Regex"),",")," sachez qu'il s'agit d'un format sp\xe9cial qui permet de\xa0",(0,i.mdx)("em",{parentName:"p"},"matcher")," du texte, c'est-\xe0-dire de\nv\xe9rifier qu'un texte corresponde \xe0 une ",(0,i.mdx)("em",{parentName:"p"},"description")," que l'on a d\xe9finie. Ainsi, si l'on veut savoir si notre texte commence par la lettre ",(0,i.mdx)("inlineCode",{parentName:"p"},"e")," et\nest suivi d'au moins 3 chiffres, on \xe9crira la\xa0",(0,i.mdx)("em",{parentName:"p"},"regex")," suivante :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"function isValid(value) {\n    return /^e[0-9]{3,}$/.test(value);\n}\n")),(0,i.mdx)("p",null,"Cela peut para\xeetre barbare comme notation, mais c'est tr\xe8s puissant et tr\xe8s pratique !"),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Pour en savoir plus, ",(0,i.mdx)("a",{parentName:"p",href:"https://regexr.com/"},"un peu de documentation")," ne fait pas de mal. \ud83d\ude09"))),(0,i.mdx)("h3",{id:"d\xe9couvrez-les-contraintes-html5"},"D\xe9couvrez les contraintes HTML5"),(0,i.mdx)("p",null,"Depuis\xa0",(0,i.mdx)("em",{parentName:"p"},"HTML")," version 5, il est possible d'ajouter de la validation ",(0,i.mdx)("strong",{parentName:"p"},"directement")," dans le code\xa0HTML, sans avoir besoin d'\xe9crire la moindre\nligne de\xa0JavaScript."),(0,i.mdx)("p",null,"Pour cela, diff\xe9rents ",(0,i.mdx)("strong",{parentName:"p"},"attributs")," sont ajout\xe9s et permettent d'",(0,i.mdx)("strong",{parentName:"p"},"emp\xeacher la soumission d'un formulaire")," si toutes les validations ne sont\npas respect\xe9es."),(0,i.mdx)("h4",{id:"lattribut-type-pour-les-inputs"},"L'attribut type pour les inputs"),(0,i.mdx)("p",null,"Pour valider les informations saisies dans une balise ",(0,i.mdx)("inlineCode",{parentName:"p"},"input"),", il est possible d'utiliser l'attribut ",(0,i.mdx)("inlineCode",{parentName:"p"},"type"),"."),(0,i.mdx)("p",null,"L'attribut ",(0,i.mdx)("inlineCode",{parentName:"p"},"type"),"\xa0de la balise ",(0,i.mdx)("inlineCode",{parentName:"p"},"input"),"\xa0ne prend pas seulement comme valeurs ",(0,i.mdx)("inlineCode",{parentName:"p"},"text"),"\xa0et ",(0,i.mdx)("inlineCode",{parentName:"p"},"password"),". Cela peut aussi \xeatre ",(0,i.mdx)("inlineCode",{parentName:"p"},"email"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"tel"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"URL"),",\n",(0,i.mdx)("inlineCode",{parentName:"p"},"date"),"\xa0et bien d'autres."),(0,i.mdx)("p",null,"Lorsque vous ajoutez un \xe9l\xe9ment ",(0,i.mdx)("inlineCode",{parentName:"p"},"input"),"\xa0avec un attribut\xa0",(0,i.mdx)("inlineCode",{parentName:"p"},'type="email"'),", le navigateur emp\xeachera la soumission du formulaire si ce n'est pas\nune adresse email correcte."),(0,i.mdx)("h4",{id:"les-attributs-de-validation-simples"},"Les attributs de validation simples"),(0,i.mdx)("p",null,"En fonction du ",(0,i.mdx)("inlineCode",{parentName:"p"},"type"),"\xa0de l'",(0,i.mdx)("inlineCode",{parentName:"p"},"input"),", vous pouvez utiliser diff\xe9rents attributs pour ",(0,i.mdx)("strong",{parentName:"p"},"perfectionner")," votre validation :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"min")," / ",(0,i.mdx)("inlineCode",{parentName:"li"},"max"),"\xa0: fonctionne avec des champs de type ",(0,i.mdx)("em",{parentName:"li"},(0,i.mdx)("strong",{parentName:"em"},"nombre"))," ou ",(0,i.mdx)("em",{parentName:"li"},(0,i.mdx)("strong",{parentName:"em"},"date")),". Cela permet de d\xe9finir une valeur minimum et une valeur\nmaximum autoris\xe9es ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"required"),"\xa0: fonctionne avec \xe0 peu pr\xe8s ",(0,i.mdx)("strong",{parentName:"li"},"tous les types de champs"),". Cela rend obligatoire le remplissage de ce champ ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"step"),"\xa0: fonctionne avec les ",(0,i.mdx)("strong",{parentName:"li"},"dates")," ou les ",(0,i.mdx)("strong",{parentName:"li"},"nombres"),". Cela permet de d\xe9finir une valeur d'incr\xe9ment lorsque vous changez la valeur du\nchamp via les fl\xe8ches ;"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"minlength"),"\xa0/ ",(0,i.mdx)("inlineCode",{parentName:"li"},"maxlength"),"\xa0: fonctionne avec les ",(0,i.mdx)("strong",{parentName:"li"},"champs textuels")," (",(0,i.mdx)("inlineCode",{parentName:"li"},"text"),", ",(0,i.mdx)("inlineCode",{parentName:"li"},"url"),", ",(0,i.mdx)("inlineCode",{parentName:"li"},"tel"),", ",(0,i.mdx)("inlineCode",{parentName:"li"},"email"),"...). Cela permet de d\xe9finir un nombre de\ncaract\xe8res minimum et maximum autoris\xe9.")),(0,i.mdx)("h4",{id:"les-patterns"},"Les patterns"),(0,i.mdx)("p",null,"Nous avons vu qu'il \xe9tait possible d'avoir une validation complexe gr\xe2ce aux\xa0Regex en\xa0JavaScript. Eh bien c'est aussi possible directement en\nHTML5 avec l'attribut ",(0,i.mdx)("inlineCode",{parentName:"p"},"pattern"),". Il suffit de d\xe9finir une\xa0Regex dans cet attribut, et vous obligez la valeur du champ correspondant \xe0 la\nrespecter."),(0,i.mdx)("p",null,"Par exemple, si on prend le code suivant :"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-html"},'<input type="text" pattern="[0-9]{,3}" />\n')),(0,i.mdx)("p",null,"il emp\xeachera un utilisateur d'entrer autre chose que des chiffres, et limitera leur nombre \xe0 3 chiffres."),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},"Pour en savoir plus, vous pouvez aller faire un tour sur ",(0,i.mdx)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5/Constraint_validation"},"MDN"),"\n(documentation en anglais)."))),(0,i.mdx)("h3",{id:"\xe0-vous-de-jouer"},"\xc0 vous de jouer\xa0!"),(0,i.mdx)("p",null,(0,i.mdx)("img",{parentName:"p",src:"https://user.oc-static.com/upload/2021/04/20/16189267631776_A-vous-de-jouer%20%282%29.png",alt:"16189267631776_A-vous-de-jouer%20%282%29.png"})),(0,i.mdx)("p",null,"Voici quelques exercices pour vous faire les dents\xa0sur la validation \ud83d\ude0e. Rendez-vous sur ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/nicolaspatschkowski/pen/GRJQvGY"},"cet \xe9diteur CodePen"),"\net r\xe9alisez les \xe9tapes suivantes:"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Nous souhaitons dans un premier temps valider le champ\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"Code"),"\xa0du formulaire. A chaque lettre saisie dans le champ ayant pour ID\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"code"),"\xa0nous\nvoulons v\xe9rifier que la valeur du champ commence bien par\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"CODE-"),"\xa0gr\xe2ce \xe0 une\xa0",(0,i.mdx)("em",{parentName:"li"},"Regex"),"\xa0que voici :\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"/^CODE-/"),". Si la valeur commence bien par\n",(0,i.mdx)("inlineCode",{parentName:"li"},"CODE-"),"\xa0alors nous affichons dans l'\xe9l\xe9ment ayant pour ID\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"code-validation"),"\xa0:\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"Code valide"),", sinon nous affichons dans cet \xe9l\xe9ment\n",(0,i.mdx)("inlineCode",{parentName:"li"},"Code invalide"),"."),(0,i.mdx)("li",{parentName:"ol"},"Maintenant que nous savons si notre code est valide ou non, nous voudrions griser (gr\xe2ce \xe0 l'attribut\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"disabled"),") le bouton de soumission\n(L'input de type\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"submit"),"\xa0ayant pour ID\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"submit-btn"),") quand le code est invalide, et le d\xe9griser quand le code est valide.",(0,i.mdx)("br",null),"\nCela signifie que nous allons devoir ajouter un attribut\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},'disabled="true"'),"\xa0au bouton de soumission quand le code est invalide. Et supprimer cet\nattribut\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"disabled"),"\xa0quand le code est valide (Rappelez-vous du cours sur la modification du DOM pour d\xe9finir et supprimer des attributs)."),(0,i.mdx)("li",{parentName:"ol"},"Finalement, nous avons un champ\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"Email"),"\xa0et nous voudrions le rendre obligatoire et obliger l'utilisateur \xe0 entrer une adresse email valide.\nIl faudra aussi emp\xeacher le formulaire de se soumettre s'il n'est pas valide.",(0,i.mdx)("br",null),"\nMais nous voudrions faire tout \xe7a uniquement avec le HTML5, sans utiliser de code JavaScript.",(0,i.mdx)("br",null),"\nVous pouvez changer le\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"type"),"\xa0du champ email plut\xf4t que d'utiliser une Regex via\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"pattern"),"\xa0",(0,i.mdx)("img",{parentName:"li",src:"https://openclassrooms.com/bundles/common/images/smiley/clin.png",alt:";)"}))),(0,i.mdx)(s.sp,{codePenId:"GRJQvGY",mdxType:"CodePen"}),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'document\n  .getElementById("code")\n  .addEventListener("input", function(e) {\n    if (/^CODE-/.test(e.target.value)) {\n      document.getElementById("code-validation").innerText = "Code valide";\n      document.getElementById("submit-btn").removeAttribute("disabled");\n    } else {\n      document.getElementById("code-validation").innerText = "Code invalide";\n      document.getElementById("submit-btn").setAttribute("disabled", true);\n    }\n});\n')),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-html"},'<label>Email : <input type="email" name="email" required /></label>\n')),(0,i.mdx)("p",null,"Vous avez termin\xe9 ? Voici la ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/fabienhenon/pen/JjbxgaZ"},"solution CodePen")," !"),(0,i.mdx)(s.sp,{codePenId:"JjbxgaZ",mdxType:"CodePen"}),(0,i.mdx)("h3",{id:"en-r\xe9sum\xe9-2"},"En r\xe9sum\xe9"),(0,i.mdx)("p",null,"Dans ce chapitre, vous avez appris :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Qu'il ne faut jamais faire confiance \xe0 l'utilisateur ;"),(0,i.mdx)("li",{parentName:"ul"},"\xc0 valider des donn\xe9es lors d'\xe9v\xe9nements ;"),(0,i.mdx)("li",{parentName:"ul"},"\xc0 utiliser les Regex pour valider les donn\xe9es ;"),(0,i.mdx)("li",{parentName:"ul"},"\xc0 utiliser les attributs fournis par HTML pour valider les donn\xe9es.")),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Maintenant qu'on peut prot\xe9ger notre site web de nos utilisateurs, et leur afficher de beaux messages d'erreur quand les donn\xe9es saisies ne\nsont pas celles attendues, nous allons pouvoir sauvegarder nos donn\xe9es sur notre service web !")),(0,i.mdx)("hr",null),(0,i.mdx)("h2",{id:"sauvegardez-des-donn\xe9es-sur-le-service-web"},"Sauvegardez des donn\xe9es sur le service web"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/5543061-ecrivez-du-javascript-pour-le-web/5577626-sauvegardez-des-donnees-sur-le-service-web"},"Sauvegardez des donn\xe9es sur le service web - \xc9crivez du JavaScript pour le web - OpenClassrooms")),(0,i.mdx)(s.fG,{vimeoId:"539127891",mdxType:"Vimeo"}),(0,i.mdx)("br",null),(0,i.mdx)("h3",{id:"envoyez-des-donn\xe9es-comment-\xe7a-marche-"},"Envoyez des donn\xe9es, comment \xe7a marche ?"),(0,i.mdx)("p",null,"Nous avons vu pr\xe9c\xe9demment que gr\xe2ce au protocole\xa0HTTP,\xa0nous pouvions demander \xe0 r\xe9cup\xe9rer des donn\xe9es de notre service web."),(0,i.mdx)("p",null,"Eh bien, c'est aussi possible d'en envoyer au service web en les ajoutant \xe0 notre requ\xeate !"),(0,i.mdx)("p",null,"Cependant, cela ne se fait pas avec toutes les\xa0m\xe9thodes (qu'on appelle aussi des\xa0",(0,i.mdx)("em",{parentName:"p"},"verbs"),")\xa0HTTP.\xa0En effet, la m\xe9thode\xa0",(0,i.mdx)("strong",{parentName:"p"},"GET")," est\xa0seulement\nfaite pour r\xe9cup\xe9rer des donn\xe9es, alors que des m\xe9thodes comme\xa0",(0,i.mdx)("strong",{parentName:"p"},"POST")," et\xa0",(0,i.mdx)("strong",{parentName:"p"},"PUT")," sont faites pour en envoyer et en recevoir."),(0,i.mdx)("p",null,"Le fonctionnement d'un verb \xe0 l'autre est tr\xe8s similaire. Avec les verbs\xa0",(0,i.mdx)("strong",{parentName:"p"},"POST")," et\xa0",(0,i.mdx)("strong",{parentName:"p"},"PUT"),", nous allons simplement ajouter des donn\xe9es dans\nle corps de notre requ\xeate."),(0,i.mdx)("h3",{id:"envoyez-des-donn\xe9es-avec-une-requ\xeate-post"},"Envoyez des donn\xe9es avec une requ\xeate POST"),(0,i.mdx)("p",null,"Afin d'envoyer des donn\xe9es \xe0 un service web avec la m\xe9thode ",(0,i.mdx)("strong",{parentName:"p"},"POST")," via AJAX, nous allons devoir passer par la m\xe9thode\xa0",(0,i.mdx)("inlineCode",{parentName:"p"},"send()")," en lui passant\nen param\xe8tres les donn\xe9es \xe0 envoyer."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"fetch(\"http://url-service-web.com/api/users\", {\n    method: \"POST\",\n    headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(jsonBody)\n});\n")),(0,i.mdx)("p",null,"Comme vous pouvez le voir, nous avons pass\xe9 le contenu \xe0 envoyer au service web \xe0 notre fonction ",(0,i.mdx)("inlineCode",{parentName:"p"},"fetch()"),". \xc9tant donn\xe9 que l'on souhaite\n",(0,i.mdx)("strong",{parentName:"p"},"envoyer du JSON")," \xe0 notre service web, nous avons d'abord besoin de transformer notre objet JavaScript en JSON (qui, rappelons-le, est un\nformat textuel, c'est-\xe0-dire que c'est simplement du texte, contrairement \xe0 un objet JavaScript qui est une structure complexe du langage)."),(0,i.mdx)("p",null,"Pour faire cette transformation, nous utilisons la fonction ",(0,i.mdx)("inlineCode",{parentName:"p"},"JSON.stringify(json)"),". Toujours parce que l'on souhaite envoyer du JSON \xe0 notre\nservice web, il faut alors le pr\xe9venir qu'il va ",(0,i.mdx)("strong",{parentName:"p"},"recevoir du JSON"),". Cela se fait gr\xe2ce \xe0 des ",(0,i.mdx)("strong",{parentName:"p"},"headers"),", qui sont des en-t\xeates envoy\xe9s en\nm\xeame temps que la requ\xeate pour donner plus d'informations sur celle-ci. Les headers en question sont\xa0 :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"Content-Type"),", avec la valeur\xa0 application/json,"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"Accept"),", avec la valeur application/json .")),(0,i.mdx)("p",null,"Ces options sont envoy\xe9es avec la requ\xeate gr\xe2ce au second param\xe8tre de la fonction ",(0,i.mdx)("em",{parentName:"p"},"fetch()"),". Ce param\xe8tre est un objet qui permet de d\xe9finir :\xa0"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"la ",(0,i.mdx)("strong",{parentName:"li"},"m\xe9thode HTTP"),", le ",(0,i.mdx)("strong",{parentName:"li"},"body"),", c\u2019est \xe0 dire les donn\xe9es qu\u2019on souhaite envoyer,"),(0,i.mdx)("li",{parentName:"ul"},"les ",(0,i.mdx)("strong",{parentName:"li"},"headers")," qui donnent un peu plus d\u2019information sur notre requ\xeate.")),(0,i.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,i.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,i.mdx)("h5",{parentName:"div"},(0,i.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,i.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.mdx)("div",{parentName:"div",className:"admonition-content"},(0,i.mdx)("p",{parentName:"div"},(0,i.mdx)("em",{parentName:"p"},"PUT")," fonctionne exactement de la m\xeame mani\xe8re que ",(0,i.mdx)("em",{parentName:"p"},"POST"),"."))),(0,i.mdx)("h3",{id:"\xe0-vous-de-jouer--1"},"\xc0 vous de jouer !"),(0,i.mdx)("p",null,(0,i.mdx)("img",{parentName:"p",src:"https://user.oc-static.com/upload/2021/04/20/16189267631776_A-vous-de-jouer%20%282%29.png",alt:"16189267631776_A-vous-de-jouer%20%282%29.png"})),(0,i.mdx)("p",null,"Voici un petit exercice, \xe0 r\xe9aliser sur ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/nicolaspatschkowski/pen/OJVQjBq"},"cet \xe9diteur CodePen"),"."),(0,i.mdx)("p",null,"Dans cet exercice nous voulons pouvoir entrer du texte dans le formulaire et l'envoyer vers un service web. Ce service web va simplement nous\nrenvoyer notre contenu en plus d'autres informations et nous allons afficher le contenu renvoy\xe9 par le serveur."),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Nous allons commencer par cr\xe9er une fonction appel\xe9e\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"send"),"\xa0et qui va cr\xe9er notre\xa0requ\xeate.",(0,i.mdx)("br",null),"\nNous souhaitons cr\xe9er une requ\xeate de type\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"POST"),"\xa0vers l'adresse suivante :\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"https://mockbin.com/request"),", et y envoyer un contenu JSON ayant\nune propri\xe9t\xe9\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"value"),"\xa0qui contiendra la valeur du champ de saisie de la page (avec l'ID\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"value"),"). Par exemple :\n",(0,i.mdx)("inlineCode",{parentName:"li"},'{value: document.getElementById("value").value}'),".",(0,i.mdx)("br",null),"\nNous souhaitons aussi, lorsque la requ\xeate s'est bien envoy\xe9e, afficher le r\xe9sulat renvoy\xe9 par le service web. Pour ce faire, nous allons\nafficher ce qui se trouve dans\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"postData.text"),"\xa0de la r\xe9ponse dans le contenu HTML de l'\xe9l\xe9ment ayant pour ID\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"result"),"."),(0,i.mdx)("li",{parentName:"ol"},"Maintenant nous voulons envoyer notre requ\xeate, et donc appeler notre fonction\xa0",(0,i.mdx)("inlineCode",{parentName:"li"},"send"),"\xa0d\xe8s que nous soumettons le formulaire ayant pour ID\n",(0,i.mdx)("inlineCode",{parentName:"li"},"form"),".")),(0,i.mdx)("p",null,"N'oubliez pas d'annuler le comportement par d\xe9faut de la soumission du formulaire, sinon votre page va se recharger."),(0,i.mdx)(s.sp,{codePenId:"OJVQjBq",mdxType:"CodePen"}),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'function send(e) {\n  e.preventDefault();\n  fetch("https://mockbin.com/request", {\n    method: "POST",\n    headers: {\n      \'Accept\': \'application/json\', \n      \'Content-Type\': \'application/json\'\n    },\n    body: JSON.stringify({value: document.getElementById("value").value})\n  })\n  .then(function(res) {\n    if (res.ok) {\n      return res.json();\n    }\n  })\n  .then(function(value) {\n      document\n        .getElementById("result")\n        .innerText = value.postData.text;\n  });\n}\n\ndocument\n  .getElementById("form")\n  .addEventListener("submit", send);\n')),(0,i.mdx)("p",null,"Voici le ",(0,i.mdx)("a",{parentName:"p",href:"https://codepen.io/fabienhenon/pen/GRNepeG"},"CodePen avec la solution"),"\xa0pour vous corriger. \ud83d\ude09"),(0,i.mdx)(s.sp,{codePenId:"GRNepeG",mdxType:"CodePen"}),(0,i.mdx)("h3",{id:"en-r\xe9sum\xe9-3"},"En r\xe9sum\xe9"),(0,i.mdx)("p",null,"Dans ce chapitre, vous avez appris :"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Que l'envoi de donn\xe9es en HTTP se\xa0fait via certains verbs : ",(0,i.mdx)("inlineCode",{parentName:"li"},"POST"),"\xa0ou ",(0,i.mdx)("inlineCode",{parentName:"li"},"PUT"),"."),(0,i.mdx)("li",{parentName:"ul"},"\xc0 envoyer des donn\xe9es en HTTP.")),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Vous savez comment envoyer des requ\xeates \xe0 un service web pour lui demander des ressources ou en cr\xe9er de nouvelles. Dans la partie suivante,\nnous aborderons l'asynchronisme en\xa0JavaScript afin d'ex\xe9cuter du code en \"parall\xe8le\".")),(0,i.mdx)("hr",null),(0,i.mdx)("h2",{id:"quiz--communiquez-avec-un-service-web"},"Quiz : Communiquez avec un service web"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/5543061-ecrivez-du-javascript-pour-le-web/exercises/3182"},"Communiquez avec un service web - OpenClassrooms")),(0,i.mdx)("h4",{id:"comp\xe9tences-\xe9valu\xe9es"},"Comp\xe9tences \xe9valu\xe9es"),(0,i.mdx)("i",{class:"bi bi-check2-circle"})," Communiquer avec un service web",(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-1--quest-ce-que-le-http-"},"Question 1 : Qu'est-ce que le HTTP ?"),(0,i.mdx)("i",{class:"bi bi-circle"})," Un protocole permettant de communiquer avec tout ce qu'on veut",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Un protocole permettant de communiquer avec un service web",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Un objet JavaScript permettant de communiquer avec tout ce qu'on veut",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Un objet JavaScript permettant de communiquer avec un service web",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"HTTP est un protocole permettant de communiquer avec des services web. Il signifie\xa0",(0,i.mdx)("strong",{parentName:"em"},"HyperText Transfer Protocol"),".")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-2--quel-objet-permet-de-cr\xe9er-des-requ\xeates-http-en-javascript-"},"Question 2 : Quel objet permet de cr\xe9er des requ\xeates HTTP en JavaScript ?"),(0,i.mdx)("i",{class:"bi bi-circle"}),(0,i.mdx)("code",null,"HttpRequest"),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"}),(0,i.mdx)("code",null,"FetchRequest"),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"}),(0,i.mdx)("code",null,"HttpFetch"),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"}),(0,i.mdx)("code",null,"Fetch"),(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"C'est ",(0,i.mdx)("inlineCode",{parentName:"em"},"Fetch")," qui permet de faire des requ\xeates HTTP vers un service web en JavaScript.")),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Elle prend en param\xe8tre l\u2019URL de destination ainsi que des options li\xe9es au param\xe9trage de la requ\xeate HTTP, et elle nous renverra une\n",(0,i.mdx)("inlineCode",{parentName:"em"},"Promise")," contenant la r\xe9ponse du service web. Pour plus d\u2019informations, je vous invite \xe0 lire la ",(0,i.mdx)("a",{parentName:"em",href:"https://developer.mozilla.org/fr/docs/Web/API/Fetch_API/Using_Fetch"},"documentation de Fetch"),".")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-3--quest-ce-que-le-json-"},"Question 3 : Qu'est-ce que le JSON ?"),(0,i.mdx)("i",{class:"bi bi-circle"})," Un format de donn\xe9es binaire, illisible et difficile \xe0 parser",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Un format textuel, peu verbeux et tr\xe8s proche de la syntaxe des objets JavaScript",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Un format textuel, tr\xe8s verbeux, mais que l'on peut tout de m\xeame utiliser en JavaScript",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"JSON signifie : ",(0,i.mdx)("strong",{parentName:"em"},"JavaScript Object Notation"),". Il s'agit d'un format textuel tr\xe8s simple et peu verbeux, que JavaScript comprend tr\xe8s\nfacilement car il est proche de sa syntaxe objet (d'o\xf9 son nom).")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-4--que-fait-cet-extrait-"},"Question 4 : Que fait cet extrait ?"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"JSON.parse(value)\n")),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Il transforme un contenu JSON en objet JavaScript",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il transforme un objet JavaScript en contenu JSON",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," La fonction \xa0`parse`\xa0 n\u2019existe pas",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},(0,i.mdx)("inlineCode",{parentName:"em"},"JSON.parse(value)")," permet bien de transformer du texte JSON en un objet JavaScript.")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-5--que-fait-cet-extrait-"},"Question 5 : Que fait cet extrait ?"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"JSON.stringify(value)\n")),(0,i.mdx)("i",{class:"bi bi-circle"})," Il transforme un contenu JSON en objet JavaScript",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Il transforme un objet JavaScript en contenu JSON",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," La fonction stringify n\u2019existe pas",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},(0,i.mdx)("inlineCode",{parentName:"em"},"JSON.stringify(value)")," va transformer un objet JavaScript pass\xe9 en param\xe8tre en un texte au format JSON.")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-6--que-va-afficher-cet-extrait-dans-la-console-"},"Question 6 : Que va afficher cet extrait dans la console ?"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},'fetch("http://url-de-mon-service")\n    .then(function(res) {\n        console.log(res.json());\n    });\n')),(0,i.mdx)("i",{class:"bi bi-circle"})," Une Promise qui sera r\xe9solue avec le contenu au format JSON de la r\xe9ponse \xe0 la requ\xeate GET",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Une Promise qui sera r\xe9solue avec l\u2019objet JavaScript qui correspond \xe0 la r\xe9ponse \xe0 la requ\xeate GET (pars\xe9e depuis du JSON)",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Le contenu de la r\xe9ponse \xe0 la requ\xeate GET au format JSON",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Le contenu de la r\xe9ponse \xe0 la requ\xeate GET directement en objet JavaScript",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Il s'agit de la 2e r\xe9ponse. En effet, la fonction ",(0,i.mdx)("inlineCode",{parentName:"em"},"json()"),"\xa0permet de transformer du contenu JSON en objet JavaScript. Mais elle ne retourne\npas directement l\u2019objet, elle retourne une Promise, qui devra \xeatre r\xe9solue.")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-7--comment-sera-trait\xe9-ce-champ-"},"Question 7 : Comment sera trait\xe9 ce champ ?"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-html"},"<input type=\u201demail\u201d required />\n")),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Il sera obligatoire et devra \xeatre au format d\u2019un e-mail",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il sera obligatoire mais pourra contenir n\u2019importe quoi, dont une adresse e-mail",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il n\u2019est pas obligatoire mais doit contenir une adresse e-mail",(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il n\u2019est obligatoire que s\u2019il contient une adresse e-mail",(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Pour forcer le champ \xe0 \xeatre une adresse e-mail, il faut que son ",(0,i.mdx)("inlineCode",{parentName:"em"},"type")," soit ",(0,i.mdx)("inlineCode",{parentName:"em"},"email"),". Pour obliger l'utilisateur \xe0 entrer une valeur dans ce\nchamp, il faut lui ajouter l'attribut ",(0,i.mdx)("inlineCode",{parentName:"em"},"required"),".")),(0,i.mdx)("hr",null),(0,i.mdx)("h4",{id:"question-8--que-fait-cet-extrait-"},"Question 8 : Que fait cet extrait ?"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-javascript"},"fetch(\"http://url-service-web\", {\n    method: \u201cPOST\u201d,\n    headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({foo: \u201cbar\u201d})\n});\n")),(0,i.mdx)("i",{class:"bi bi-circle"})," Il fait une requ\xeate de type GET avec le contenu JSON ",(0,i.mdx)("code",null,'"{"foo": "bar"}"'),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-record-circle"})," Il fait une requ\xeate de type POST avec le contenu JSON ",(0,i.mdx)("code",null,'"{"foo": "bar"}"'),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il fait une requ\xeate de type GET avec le contenu JSON ",(0,i.mdx)("code",null,'{foo: "bar"}'),(0,i.mdx)("br",null),(0,i.mdx)("i",{class:"bi bi-circle"})," Il fait une requ\xeate de type POST avec le contenu JSON ",(0,i.mdx)("code",null,'{foo: "bar"}'),(0,i.mdx)("br",null),(0,i.mdx)("br",null),(0,i.mdx)("p",null,(0,i.mdx)("em",{parentName:"p"},"Faites bien attention au fait que la fonction JSON.stringify transforme notre objet JavaScript en JSON, et que le JSON n\u2019est rien d\u2019autre que\ndu texte. Dans notre exemple, la r\xe9ponse 4 n\u2019est pas valide car ",(0,i.mdx)("inlineCode",{parentName:"em"},'{foo: "bar\u201d}')," est du JavaScript et non du JSON.")))}c.isMDXComponent=!0}}]);