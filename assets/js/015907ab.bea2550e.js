"use strict";(self.webpackChunkmon_web_dev_wiki=self.webpackChunkmon_web_dev_wiki||[]).push([[2247],{15527:function(e,n,a){a.r(n),a.d(n,{frontMatter:function(){return r},contentTitle:function(){return o},metadata:function(){return d},toc:function(){return u},default:function(){return c}});var l=a(87462),i=a(63366),t=(a(67294),a(3905)),s=(a(9877),a(58215),a(56222)),m=["components"],r={sidebar_position:5},o="Modifiez le format de vos donn\xe9es selon les \xe9volutions de votre application",d={unversionedId:"OpenClassrooms/Creez_un_reseau_social_d_entreprise/Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application",id:"OpenClassrooms/Creez_un_reseau_social_d_entreprise/Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application",title:"Modifiez le format de vos donn\xe9es selon les \xe9volutions de votre application",description:"Modifiez la structure d\u2019un objet avec ALTER TABLE",source:"@site/docs/OpenClassrooms/7-Creez_un_reseau_social_d_entreprise/2-Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/4-Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application.mdx",sourceDirName:"OpenClassrooms/7-Creez_un_reseau_social_d_entreprise/2-Implementez_vos_bases_de_donnees_relationnelles_avec_SQL",slug:"/OpenClassrooms/Creez_un_reseau_social_d_entreprise/Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Creez_un_reseau_social_d_entreprise/Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application",editUrl:"https://github.com/gylgyl2000/Mon_Web_Dev_Wiki/edit/master/website/docs/OpenClassrooms/7-Creez_un_reseau_social_d_entreprise/2-Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/4-Modifiez_le_format_de_vos_donnees_selon_les_evolutions_de_votre_application.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"openClassroomsSidebar",previous:{title:"Effectuez des requ\xeates SQL avanc\xe9es",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Creez_un_reseau_social_d_entreprise/Implementez_vos_bases_de_donnees_relationnelles_avec_SQL/Effectuez_des_requetes_SQL_avancees"},next:{title:"Sources du tutorial",permalink:"/Mon_Web_Dev_Wiki/docs/OpenClassrooms/Creez_un_reseau_social_d_entreprise/Creation_de_l_application_full-stack_CRUD/Sources"}},u=[{value:"Modifiez la structure d\u2019un objet avec ALTER TABLE",id:"modifiez-la-structure-dun-objet-avec-alter-table",children:[{value:"Ajoutez un champ",id:"ajoutez-un-champ",children:[{value:"Ajoutez un champ aux aliments",id:"ajoutez-un-champ-aux-aliments",children:[],level:4}],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer-",children:[],level:3},{value:"Supprimez un champ",id:"supprimez-un-champ",children:[{value:"Supprimez un champ aux aliments",id:"supprimez-un-champ-aux-aliments",children:[],level:4}],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--1",children:[],level:3},{value:"Modifiez un champ existant",id:"modifiez-un-champ-existant",children:[{value:"Modifiez un champ des aliments",id:"modifiez-un-champ-des-aliments",children:[],level:4}],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--2",children:[],level:3},{value:"Renommez un champ des aliments",id:"renommez-un-champ-des-aliments",children:[],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--3",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9",children:[],level:3}],level:2},{value:"Ajoutez une relation un \xe0 plusieurs",id:"ajoutez-une-relation-un-\xe0-plusieurs",children:[{value:"Ajoutez une nouvelle table \u201cfamille\u201d",id:"ajoutez-une-nouvelle-table-famille",children:[],level:3},{value:"Ajoutez la relation entre famille et aliment",id:"ajoutez-la-relation-entre-famille-et-aliment",children:[],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--4",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9-1",children:[],level:3}],level:2},{value:"Ajoutez une relation plusieurs \xe0 plusieurs",id:"ajoutez-une-relation-plusieurs-\xe0-plusieurs",children:[{value:"Ajoutez une nouvelle table \u201clieu\u201d",id:"ajoutez-une-nouvelle-table-lieu",children:[],level:3},{value:"Ajoutez la table de liaison",id:"ajoutez-la-table-de-liaison",children:[],level:3},{value:"\xc0 vous de jouer !",id:"\xe0-vous-de-jouer--5",children:[],level:3},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9-2",children:[],level:3}],level:2},{value:"Terminez votre apprentissage",id:"terminez-votre-apprentissage",children:[],level:2},{value:"Quiz : Transformez la structure d\u2019une base de donn\xe9es",id:"quiz--transformez-la-structure-dune-base-de-donn\xe9es",children:[{value:"Comp\xe9tences \xe9valu\xe9es",id:"comp\xe9tences-\xe9valu\xe9es",children:[],level:4},{value:"Description",id:"description",children:[],level:4},{value:"Question 1 : Quels sont les mots cl\xe9s disponibles dans une commande de type ALTER TABLE ?",id:"question-1--quels-sont-les-mots-cl\xe9s-disponibles-dans-une-commande-de-type-alter-table-",children:[],level:4},{value:"Question 2 : Comment fait-on pour ajouter une relation un \xe0 plusieurs entre deux objets existants d\xe9j\xe0 en base ?",id:"question-2--comment-fait-on-pour-ajouter-une-relation-un-\xe0-plusieurs-entre-deux-objets-existants-d\xe9j\xe0-en-base-",children:[],level:4},{value:"Question 3 : Dans la BDD Moviz, quelle est la commande qui permet de rajouter le champ \u201cnote_id\u201d \xe0 la table \u201cfilm\u201d ?",id:"question-3--dans-la-bdd-moviz-quelle-est-la-commande-qui-permet-de-rajouter-le-champ-note_id-\xe0-la-table-film-",children:[],level:4},{value:"Question 4 : Quelle est la commande qui permet de supprimer le budget sur les films ?",id:"question-4--quelle-est-la-commande-qui-permet-de-supprimer-le-budget-sur-les-films-",children:[],level:4},{value:"Question 5 : Quelle est la commande qui permet de modifier le type du champ \u201cbudget\u201d d\u2019entier vers d\xe9cimal ?",id:"question-5--quelle-est-la-commande-qui-permet-de-modifier-le-type-du-champ-budget-dentier-vers-d\xe9cimal-",children:[],level:4},{value:"Question 6 : Quelle est la commande qui permet de renommer le budget sur les films en \u201ccout_de_production\u201d ?",id:"question-6--quelle-est-la-commande-qui-permet-de-renommer-le-budget-sur-les-films-en-cout_de_production-",children:[],level:4},{value:"Question 7 : Comment cr\xe9e-t-on une relation plusieurs \xe0 plusieurs entre deux objets existants d\xe9j\xe0 en base ?",id:"question-7--comment-cr\xe9e-t-on-une-relation-plusieurs-\xe0-plusieurs-entre-deux-objets-existants-d\xe9j\xe0-en-base-",children:[],level:4},{value:"Question 8 : Quelle est la commande qui permet de cr\xe9er la table de liaison entre \u201cfilm\u201d et \u201cpays_de_sortie\u201d ?",id:"question-8--quelle-est-la-commande-qui-permet-de-cr\xe9er-la-table-de-liaison-entre-film-et-pays_de_sortie-",children:[],level:4}],level:2}],p={toc:u};function c(e){var n=e.components,a=(0,i.Z)(e,m);return(0,t.mdx)("wrapper",(0,l.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,t.mdx)("h1",{id:"modifiez-le-format-de-vos-donn\xe9es-selon-les-\xe9volutions-de-votre-application"},"Modifiez le format de vos donn\xe9es selon les \xe9volutions de votre application"),(0,t.mdx)("h2",{id:"modifiez-la-structure-dun-objet-avec-alter-table"},"Modifiez la structure d\u2019un objet avec ALTER TABLE"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142288-modifiez-la-structure-d-un-objet-avec-alter-table"},"Modifiez la structure d\u2019un objet avec ALTER TABLE - Impl\xe9mentez vos bases de donn\xe9es relationnelles avec SQL - OpenClassrooms")),(0,t.mdx)(s.fG,{vimeoId:"497953098",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("p",null,"Ins\xe9rer de la donn\xe9e, la modifier, la supprimer, ou bien en tirer des informations utiles est d\xe9sormais \xe0 votre port\xe9e. Bien jou\xe9 !"),(0,t.mdx)("p",null,"Mais il reste une chose \xe0 voir, une chose importante dont vous aurez toujours besoin si vous souhaitez adapter votre BDD aux \xe9volutions de\nvotre application."),(0,t.mdx)("p",null,"Vous voyez laquelle c\u2019est ? \ud83e\udd14"),(0,t.mdx)("p",null,"Il s\u2019agit de la ",(0,t.mdx)("strong",{parentName:"p"},"modification de la structure")," de la BDD en elle-m\xeame. Commen\xe7ons simplement par l\u2019ajout et la suppression de champs."),(0,t.mdx)("h3",{id:"ajoutez-un-champ"},"Ajoutez un champ"),(0,t.mdx)("h4",{id:"ajoutez-un-champ-aux-aliments"},"Ajoutez un champ aux aliments"),(0,t.mdx)("p",null,"Le dernier rapport sur l\u2019utilisation de Foodly vient de tomber. Dans celui-ci, les utilisateurs ont pu voter pour les am\xe9liorations qu\u2019ils\nsouhaiteraient voir appara\xeetre dans l\u2019application."),(0,t.mdx)("p",null,"La plus demand\xe9e \xe9tait celle de voir la contenance en vitamines de chaque aliment."),(0,t.mdx)("p",null,"Sachant cela, l\u2019\xe9quipe de Foodly organise une r\xe9union concernant l\u2019impl\xe9mentation d\u2019une telle fonctionnalit\xe9. Le design est pr\xeat, les\nd\xe9veloppeurs ont cod\xe9 l\u2019interface, mais il manque une chose cruciale pour r\xe9cup\xe9rer la contenance en vitamines dans l\u2019application : l\u2019ajout de\ncette donn\xe9e dans la BDD."),(0,t.mdx)("p",null,"Prenons l\u2019exemple de la vitamine C."),(0,t.mdx)("p",null,"Cette colonne n\u2019appara\xeet nulle part dans le sch\xe9ma de la table aliment. Il nous faut la cr\xe9er."),(0,t.mdx)("p",null,"De la m\xeame mani\xe8re que vous l\u2019avez fait lors de la premi\xe8re partie, il faudra sp\xe9cifier son type \xe0 MySQL. Pour ce faire, utilisez la commande\n",(0,t.mdx)("strong",{parentName:"p"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE")),"."),(0,t.mdx)("p",null,"Voyons \xe0 quoi ressemble la commande SQL pour rajouter cette colonne, puis d\xe9cortiquons-la ensemble :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment ADD vitamines_c FLOAT;\n")),(0,t.mdx)("p",null,"Ici, on signale \xe0 MySQL :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"de modifier la structure d\u2019une table avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE"))," ;"),(0,t.mdx)("li",{parentName:"ul"},"quelle table modifier (ici \u201caliment\u201d) ;"),(0,t.mdx)("li",{parentName:"ul"},"que la modification va faire ajouter une colonne avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ADD")),";"),(0,t.mdx)("li",{parentName:"ul"},"le nom de cette nouvelle colonne (ici \u201cvitamines_c\u201d) ;"),(0,t.mdx)("li",{parentName:"ul"},"enfin, le type de la colonne (ici, ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"FLOAT")),", car les vitamines sont stock\xe9es usuellement en mg/100g, valeur d\xe9cimale).")),(0,t.mdx)("figure",null,(0,t.mdx)("img",{src:"https://user.oc-static.com/upload/2021/01/18/16109647551199_P4_ALTER-TABLE.png",alt:"R\xe9capitulatif visuel du paragraphe r\xe9dig\xe9 ci-dessus"}),(0,t.mdx)("figcaption",null,"La commande ALTER TABLE")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"\xc0 noter que le type n\u2019est parfois pas seul. On peut aussi (comme dans la partie 1), mentionner \xe0 MySQL qu\u2019on rajoute une colonne qui est :"),(0,t.mdx)("ul",{parentName:"div"},(0,t.mdx)("li",{parentName:"ul"},"une cl\xe9 primaire (",(0,t.mdx)("strong",{parentName:"li"},"PRIMARY KEY"),") ;"),(0,t.mdx)("li",{parentName:"ul"},"avec une valeur par d\xe9faut (",(0,t.mdx)("strong",{parentName:"li"},"DEFAULT valeur_par_d\xe9faut"),") ;"),(0,t.mdx)("li",{parentName:"ul"},"non nulle (",(0,t.mdx)("strong",{parentName:"li"},"NOT NULL"),"). Auquel cas il faudra pr\xe9ciser une valeur par d\xe9faut, MySQL cr\xe9ant la colonne avec la valeur \u201cNULL\u201d pour tous les\nobjets existants dans cette table ;"),(0,t.mdx)("li",{parentName:"ul"},"etc.")))),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer-"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"Faisons un petit exercice :"),(0,t.mdx)("blockquote",null,(0,t.mdx)("p",{parentName:"blockquote"},"Admettons que l\u2019on souhaite rajouter une colonne \xe0 la table \u201clangue\u201d. Cette colonne, c\u2019est ",(0,t.mdx)("a",{parentName:"p",href:"http://www.lingoes.net/en/translator/langcode.htm"},"le code ISO des langues"),"\n(par exemple : \u201cfr-fr\u201d pour le Fran\xe7ais de m\xe9tropole).")),(0,t.mdx)("p",null,"Comment feriez-vous cela ?"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE langue ADD code VARCHAR(100);\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> SELECT * FROM langue;\n+----+----------+------+\n| id | nom      | code |\n+----+----------+------+\n|  1 | fran\xe7ais | NULL |\n|  2 | anglais  | NULL |\n+----+----------+------+\n2 rows in set (0.00 sec)\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> UPDATE langue SET code = 'fr-fr' WHERE id = 1;\n\nmysql> UPDATE langue SET code = 'en-uk' WHERE id = 2;\n\nmysql> SELECT * FROM langue;\n+----+----------+-------+\n| id | nom      | code  |\n+----+----------+-------+\n|  1 | fran\xe7ais | fr-fr |\n|  2 | anglais  | en-uk |\n+----+----------+-------+\n2 rows in set (0.00 sec)\n")),(0,t.mdx)("p",null,"Tentez de cr\xe9er la colonne et de la remplir par vous-m\xeame pour le Fran\xe7ais et l\u2019Anglais. Voici la correction :"),(0,t.mdx)(s.fG,{vimeoId:"497578353",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous savez d\xe9sormais ajouter un champ \xe0 une table. \ud83d\ude4c"))),(0,t.mdx)("h3",{id:"supprimez-un-champ"},"Supprimez un champ"),(0,t.mdx)("h4",{id:"supprimez-un-champ-aux-aliments"},"Supprimez un champ aux aliments"),(0,t.mdx)("p",null,"Le management de chez Foodly nous mentionne d\u2019autres changements \xe0 effectuer sur l\u2019application, qui impliquent la BDD. C\u2019est une nouvelle\nsurprenante !"),(0,t.mdx)("p",null,"Les utilisateurs de Foodly n\u2019utilisent que tr\xe8s rarement la fonctionnalit\xe9 pour savoir si un aliment est bio ou non. \ud83d\ude22"),(0,t.mdx)("p",null,"Les d\xe9veloppeurs, dans leur volont\xe9 de toujours diminuer la dette technique (\xe0 savoir, le code \xe0 maintenir), souhaitent retirer l\u2019affichage bio\nde la fiche des aliments sur Foodly."),(0,t.mdx)("p",null,"En tant que gestionnaire de la BDD, vous pensez qu\u2019il serait pratique de faire de m\xeame de votre c\xf4t\xe9, pour \xe9viter de maintenir un champ qui ne\nsera plus mis \xe0 jour."),(0,t.mdx)("p",null,"Pour ce faire, rien de plus simple : supprimons la colonne \u201cbio\u201d de la table \u201caliment\u201d avec ",(0,t.mdx)("inlineCode",{parentName:"p"},"DROP"),"."),(0,t.mdx)("p",null,"Voici la commande SQL pour le faire :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment DROP bio;\n")),(0,t.mdx)("p",null,"D\xe9composons cette commande ensemble :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"On modifie toujours la structure d\u2019une table avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE")),"."),(0,t.mdx)("li",{parentName:"ul"},"On lui signale \xe0 nouveau quelle table modifier (ici, \u201caliment\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On lui indique que la modification va supprimer une colonne avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"DROP")),"."),(0,t.mdx)("li",{parentName:"ul"},"On mentionne le nom de la colonne \xe0 supprimer (ici, \u201cbio\u201d).")),(0,t.mdx)("figure",null,(0,t.mdx)("img",{src:"https://user.oc-static.com/upload/2021/01/18/16109647839763_P4_DROP.png",alt:"R\xe9capitulatif visuel du paragraphe r\xe9dig\xe9 ci-dessus"}),(0,t.mdx)("figcaption",null,"Utilisation de DROP")),(0,t.mdx)("p",null,"Vous voyez, c\u2019est vraiment tr\xe8s simple. \ud83d\ude09"),(0,t.mdx)("div",{className:"admonition admonition-caution alert alert--warning"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Il faut n\xe9anmoins faire attention lorsqu\u2019on utilise cette commande. Une fois la colonne supprim\xe9e, celle-ci est ",(0,t.mdx)("strong",{parentName:"p"},"d\xe9finitivement d\xe9truite")," et\nne peut plus \xeatre r\xe9cup\xe9r\xe9e. Vous perdez l\u2019information pour tous les objets pr\xe9sents en base. ",(0,t.mdx)("strong",{parentName:"p"},"\xc0 utiliser avec parcimonie !")))),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer--1"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"Maintenant, admettons que le service l\xe9gal de Foodly vous dise que stocker des noms de famille va \xe0 l\u2019encontre des conditions de protection des\ndonn\xe9es des utilisateurs."),(0,t.mdx)("p",null,"Comment feriez-vous pour supprimer les noms de famille ?"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> SELECT * FROM utilisateur;\n+----+-------------+------------+----------------------+-----------+\n| id | nom         | prenom     | email                | langue_id |\n+----+-------------+------------+----------------------+-----------+\n|  1 | durantay    | quentin    | qentin@gmail.com     |         1 |\n|  2 | dupont      | marie      | marie@hotmail.fr     |         1 |\n|  3 | miller      | vincent    | vm@yahoo.com         |         2 |\n|  4 | zuckerberg  | marc       | marc@gmail.com       |         2 |\n|  5 | paul        | pierre     | pp@orange.fr         |         1 |\n|  6 | de vauclerc | lisa       | lisadv@gmail.com     |         1 |\n|  7 | gluntig     | \xe9l\xe9onore   | glunt@sfr.com        |         1 |\n|  8 | cavill      | henry      | henry@outlook.fr     |         2 |\n|  9 | hopper      | lionel     | hpp@gmail.com        |         2 |\n| 10 | tember      | fabienne   | fabienne@yopmail.com |         1 |\n+----+-------------+------------+----------------------+-----------+\n10 rows in set (0,00 sec)\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> ALTER TABLE utilisateur DROP nom;\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> SELECT * FROM utilisateur;\n+----+------------+----------------------+-----------+\n| id | prenom     | email                | langue_id |\n+----+------------+----------------------+-----------+\n|  1 | quentin    | qentin@gmail.com     |         1 |\n|  2 | marie      | marie@hotmail.fr     |         1 |\n|  3 | vincent    | vm@yahoo.com         |         2 |\n|  4 | marc       | marc@gmail.com       |         2 |\n|  5 | pierre     | pp@orange.fr         |         1 |\n|  6 | lisa       | lisadv@gmail.com     |         1 |\n|  7 | \xe9l\xe9onore   | glunt@sfr.com        |         1 |\n|  8 | henry      | henry@outlook.fr     |         2 |\n|  9 | lionel     | hpp@gmail.com        |         2 |\n| 10 | fabienne   | fabienne@yopmail.com |         1 |\n+----+------------+----------------------+-----------+\n10 rows in set (0,00 sec)\n")),(0,t.mdx)("p",null,"Essayez de la faire. Si vous \xeates coinc\xe9, l\xe0 correction est juste ici \ud83d\udc47"),(0,t.mdx)(s.fG,{vimeoId:"497578371",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Ajouter, supprimer, vous voil\xe0 ma\xeetre en mati\xe8re de modification de sch\xe9ma de table ! Enfin\u2026 pas trop vite ! Que se passerait-il si vous deviez\nmodifier une colonne existante ?"))),(0,t.mdx)("p",null,"C\u2019est ce que vous allez voir par la suite."),(0,t.mdx)("h3",{id:"modifiez-un-champ-existant"},"Modifiez un champ existant"),(0,t.mdx)("h4",{id:"modifiez-un-champ-des-aliments"},"Modifiez un champ des aliments"),(0,t.mdx)("p",null,"Le management de Foodly revient encore une fois vers vous !"),(0,t.mdx)("p",null,"Apr\xe8s avoir regard\xe9 des utilisateurs se servir de Foodly, ils se sont rendu compte que les utilisateurs souhaiteraient pouvoir filtrer les\naliments selon leurs apports calorifiques avec plus de pr\xe9cision."),(0,t.mdx)("p",null,"Pour ce faire, les d\xe9veloppeurs vous indiquent qu\u2019ils vont devoir comparer les calories de deux aliments entre eux, et ce, \xe0 la virgule pr\xe8s."),(0,t.mdx)("p",null,"Or, les calories sont actuellement stock\xe9es sous forme d\u2019entiers (sans d\xe9cimales, du coup). Comment les modifier ?"),(0,t.mdx)("p",null,"Voici la commande pour effectuer cette op\xe9ration :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment MODIFY calories FLOAT;\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Analysons cette commande :"),(0,t.mdx)("ul",{parentName:"div"},(0,t.mdx)("li",{parentName:"ul"},"On modifie toujours la structure d\u2019une table avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE")),"."),(0,t.mdx)("li",{parentName:"ul"},"On lui signale \xe0 nouveau quelle table modifier (ici, \u201caliment\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On lui indique que la modification va modifier le type d\u2019une colonne avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"MODIFY")),"."),(0,t.mdx)("li",{parentName:"ul"},"On mentionne le nom de la colonne \xe0 modifier (ici, \u201ccalories\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On indique le nouveau type de la colonne (ici, ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"FLOAT")),").")))),(0,t.mdx)("figure",null,(0,t.mdx)("img",{src:"https://user.oc-static.com/upload/2021/01/18/16109648446119_P4_MODIFY-FLOAT.png",alt:"R\xe9capitulatif visuel du paragraphe r\xe9dig\xe9 ci-dessus"}),(0,t.mdx)("figcaption",null,"L'utilisation de FLOAT")),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer--2"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"Les d\xe9veloppeurs viennent vous voir affol\xe9s ! Certains utilisateurs ne peuvent pas s\u2019inscrire car leur email d\xe9passe les 255 caract\xe8res."),(0,t.mdx)("p",null,"Pourriez-vous augmenter la limite \xe0 500 ?"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> SHOW COLUMNS FROM utilisateur;\n+-----------+--------------+------+-----+---------+----------------+\n| Field     | Type         | Null | Key | Default | Extra          |\n+-----------+--------------+------+-----+---------+----------------+\n| id        | int          | NO   | PRI | NULL    | auto_increment |\n| nom       | varchar(100) | YES  |     | NULL    |                |\n| prenom    | varchar(100) | YES  |     | NULL    |                |\n| email     | varchar(255) | NO   | UNI | NULL    |                |\n| langue_id | int          | NO   | MUL | NULL    |                |\n+-----------+--------------+------+-----+---------+----------------+\n4 rows in set (0.01 sec)\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> ALTER TABLE utilisateur MODIFY email VARCHAR(500) NOT NULL;\n\nmysql> SHOW COLUMNS FROM utilisateur;\n+-----------+--------------+------+-----+---------+----------------+\n| Field     | Type         | Null | Key | Default | Extra          |\n+-----------+--------------+------+-----+---------+----------------+\n| id        | int          | NO   | PRI | NULL    | auto_increment |\n| nom       | varchar(100) | YES  |     | NULL    |                |\n| prenom    | varchar(100) | YES  |     | NULL    |                |\n| email     | varchar(500) | NO   | UNI | NULL    |                |\n| langue_id | int          | NO   | MUL | NULL    |                |\n+-----------+--------------+------+-----+---------+----------------+\n4 rows in set (0.01 sec)\n")),(0,t.mdx)("p",null,"Tentez par vous-m\xeame. Une fois fait, voici la correction :"),(0,t.mdx)(s.fG,{vimeoId:"497578391",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Plut\xf4t pratique de savoir modifier le type d\u2019une colonne, non ? Mais que se passerait-il si vous souhaitiez changer le nom de cette derni\xe8re ?"),(0,t.mdx)("p",{parentName:"div"},"D\xe9couvrons-le !"))),(0,t.mdx)("h3",{id:"renommez-un-champ-des-aliments"},"Renommez un champ des aliments"),(0,t.mdx)("p",null,"Ce coup-ci, c\u2019est la designer de Foodly qui revient vers vous : les utilisateurs sont perturb\xe9s\u2026 \ud83d\ude28 Pour chaque aliment, la valeur en prot\xe9ines,\nvitamines, mati\xe8res grasses est mentionn\xe9e au pluriel. Alors que les sucres, eux, sont mentionn\xe9s au singulier. Ce qui perturbe la compr\xe9hension\ndes aliments par les utilisateurs."),(0,t.mdx)("p",null,"Comment renommer cette colonne dans la BDD ?"),(0,t.mdx)("p",null,"Voici la commande \xe0 effectuer :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment CHANGE sucre sucres FLOAT;\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Voici les explications de cette commande :"),(0,t.mdx)("ul",{parentName:"div"},(0,t.mdx)("li",{parentName:"ul"},"On modifie toujours la structure d\u2019une table avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE")),"."),(0,t.mdx)("li",{parentName:"ul"},"On lui signale \xe0 nouveau quelle table modifier (ici, \u201caliment\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On lui indique que la modification va modifier le nom d\u2019une colonne avec ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"CHANGE")),"."),(0,t.mdx)("li",{parentName:"ul"},"On mentionne le nom de la colonne \xe0 renommer, ",(0,t.mdx)("strong",{parentName:"li"},"ainsi que")," son nouveau nom (ici, \u201csucre\u201d devient \u201csucres\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On indique le nouveau type de la colonne (ici, ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"FLOAT")),").")))),(0,t.mdx)("p",null,"C\u2019est une sp\xe9cificit\xe9 propre \xe0 MySQL : pour renommer une colonne, il faut aussi indiquer son type. Ce qui n\u2019est pas n\xe9cessaire si vous utilisez\nun autre SGBD. Cela permet de modifier \xe0 la fois le nom et le type d\u2019une colonne dans une seule commande. Et ce, m\xeame si vous ne souhaitez pas\nle modifier (r\xe9utilisez alors le m\xeame type \ud83d\ude09)."),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer--3"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"A pr\xe9sent, les d\xe9veloppeurs trouvent que le nom \u201ccode\u201d dans la table des langues est peu explicite. Ils aimeraient qu\u2019elle s\u2019appelle\n\u201ccode_pays\u201d."),(0,t.mdx)("p",null,"Pouvez-vous impl\xe9menter ce changement ?"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> SELECT * FROM langue;\n+----+----------+-------+\n| id | nom      | code  |\n+----+----------+-------+\n|  1 | fran\xe7ais | fr-fr |\n|  2 | anglais  | en-uk |\n+----+----------+-------+\n2 rows in set (0.00 sec)\n")),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> ALTER TABLE langue CHANGE code code_pays VARCHAR(100);\n\nmysql> SELECT * FROM langue;\n+----+----------+-----------+\n| id | nom      | code_pays |\n+----+----------+-----------+\n|  1 | fran\xe7ais | fr-fr     |\n|  2 | anglais  | en-uk     |\n+----+----------+-----------+\n2 rows in set (0.00 sec)\n")),(0,t.mdx)("p",null,"Une fois que vous aurez essay\xe9, retrouvez ci-dessous la correction \ud83d\udc47"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142288-modifiez-la-structure-d-un-objet-avec-alter-table#popin-download-video"},"T\xe9l\xe9charger la vid\xe9o")),(0,t.mdx)("h3",{id:"en-r\xe9sum\xe9"},"En r\xe9sum\xe9"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"Vous savez que toute modification de la structure d\u2019un objet s\u2019effectue avec une commande ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ALTER TABLE")),"."),(0,t.mdx)("li",{parentName:"ul"},"Pour ajouter un champ \xe0 un objet, il vous faut utiliser le mot cl\xe9 ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ADD")),"."),(0,t.mdx)("li",{parentName:"ul"},"Pour supprimer un champ, le mot cl\xe9 est ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"DROP")),"."),(0,t.mdx)("li",{parentName:"ul"},"Pour modifier un champ, le mot cl\xe9 est ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"MODIFY"))," pour en modifier la structure, ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"CHANGE"))," pour le renommer.")),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Vous voil\xe0 capable de totalement modifier le sch\xe9ma d\u2019une table d\u2019une BDD MySQL. Vous \xeates presque ma\xeetre en BDD MySQL. \ud83d\udc4c")),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Presque ? Il vous reste encore \xe0 apprendre \xe0 modifier des relations dans une table ! Ne vous inqui\xe9tez pas, vous allez tout comprendre dans le\nchapitre suivant.")),(0,t.mdx)("hr",null),(0,t.mdx)("h2",{id:"ajoutez-une-relation-un-\xe0-plusieurs"},"Ajoutez une relation un \xe0 plusieurs"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142296-ajoutez-une-relation-un-a-plusieurs"},"Ajoutez une relation un \xe0 plusieurs - Impl\xe9mentez vos bases de donn\xe9es relationnelles avec SQL - OpenClassrooms")),(0,t.mdx)(s.fG,{vimeoId:"497953128",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("p",null,'Voyons dans ce chapitre comment ajouter une relation un \xe0 plusieurs, en cr\xe9ant notre table "famille". Puis retrouvez dans le chapitre suivant\ncomment ajouter une relation plusieurs \xe0 plusieurs avec la cr\xe9ation de la table "lieu".'),(0,t.mdx)("h3",{id:"ajoutez-une-nouvelle-table-famille"},"Ajoutez une nouvelle table \u201cfamille\u201d"),(0,t.mdx)("p",null,"Nous avons obtenu une nouvelle demande d\u2019am\xe9lioration de l\u2019application de la part des utilisateurs !"),(0,t.mdx)("p",null,"Ces derniers aimeraient pouvoir trier les aliments selon leur \u201cfamille\u201d. Par exemple, regrouper ensemble les fruits, les l\xe9gumes, les viandes,\netc."),(0,t.mdx)("p",null,"Les d\xe9veloppeurs pensent qu\u2019il serait utile de s\xe9parer ces familles des aliments. En effet, ils pensent que les familles d\u2019aliments pourront\n\xeatre utilis\xe9es de mani\xe8re ind\xe9pendante, pas forc\xe9ment uniquement sur les fiches des aliments."),(0,t.mdx)("p",null,"Par exemple, pour effectuer un r\xe9sum\xe9 de la consommation en fruits ou l\xe9gumes d\u2019une personne sur un mois, ou la r\xe9partition au sein de ses\ncourses."),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Pour cela, il faudrait que les familles d\u2019aliments soient sur une table distincte de celle des aliments !"))),(0,t.mdx)("p",null,"Maintenant que vous savez ",(0,t.mdx)("strong",{parentName:"p"},"joindre")," plusieurs tables entre elles, il est temps de construire une telle relation entre tables. Qu\u2019en\ndites-vous ?"),(0,t.mdx)("p",null,"Avant de pouvoir relier les aliments \xe0 leur famille, il faut d\u2019abord\u2026 eh bien, cr\xe9er la table famille !"),(0,t.mdx)("p",null,"Pour l\u2019instant, un objet de type famille ne devra contenir que le nom de cette famille (\u201cfruit\u201d, \u201cviande\u201d, etc.)."),(0,t.mdx)("p",null,"Vous avez d\xe9j\xe0 vu comment cr\xe9er une table. Je vous fais confiance pour cr\xe9er celle-ci. \ud83d\ude09"),(0,t.mdx)("p",null,"C\u2019est fait ? Voici la correction :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE famille (\nid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\nnom VARCHAR(100) NOT NULL\n);\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous ne comprenez pas cette commande ou vous ne vous souvenez plus des types ? Je vous invite \xe0 relire le ",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142232-creez-votre-base-de-donnees-bdd"},"troisi\xe8me chapitre de la premi\xe8re partie"),". \ud83d\ude09"))),(0,t.mdx)("p",null,"Maintenant que cette table est cr\xe9\xe9e, ins\xe9rons un objet dans celle-ci. Disons, l\u2019objet qui va repr\xe9senter les l\xe9gumes."),(0,t.mdx)("p",null,"Vous vous souvenez de la commande ? La voici :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO famille (`nom`) VALUES ('l\xe9gumes');\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous \xeates perdu face \xe0 cette commande ? Relisez le ",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142248-inserez-des-donnees-dans-votre-bdd"},"premier chapitre de la deuxi\xe8me partie"),". \ud83d\ude09"))),(0,t.mdx)("p",null,"Et voil\xe0, vous voici en possession d\u2019une nouvelle table \u201cfamille\u201d qui dispose d\u2019un objet \u201cl\xe9gumes\u201d."),(0,t.mdx)("p",null,"Passons \xe0 la suite et adaptons notre BDD pour stocker la relation entre les aliments et leur famille."),(0,t.mdx)("h3",{id:"ajoutez-la-relation-entre-famille-et-aliment"},"Ajoutez la relation entre famille et aliment"),(0,t.mdx)("p",null,"Une des choses \xe0 d\xe9terminer lors de l\u2019ajout d\u2019une relation, c\u2019est de savoir si :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"c\u2019est une relation ",(0,t.mdx)("strong",{parentName:"li"},"un \xe0 plusieurs")," ;"),(0,t.mdx)("li",{parentName:"ul"},"ou une relation ",(0,t.mdx)("strong",{parentName:"li"},"plusieurs \xe0 plusieurs"),".")),(0,t.mdx)("p",null,"Ici, un aliment peut avoir une seule famille, mais une famille peut \xeatre pr\xe9sente sur plusieurs aliments. Par exemple, une poire et une pomme\nfont partie de la famille \u201cfruits\u201d."),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Il s\u2019agit donc d\u2019une relation un \xe0 plusieurs."))),(0,t.mdx)("p",null,"Dans le cadre d\u2019une telle relation, ",(0,t.mdx)("strong",{parentName:"p"},"c\u2019est l\u2019objet qui se trouve du c\xf4t\xe9 \u201cplusieurs\u201d de la relation qui va \xeatre modifi\xe9"),", ici les aliments.\nOn va devoir y stocker l\u2019id de l\u2019objet \u201cun\u201d associ\xe9, par exemple \u201cfruits\u201d."),(0,t.mdx)("p",null,"Ici, les aliments vont donc devoir \xeatre mis \xe0 jour pour y stocker une r\xe9f\xe9rence \xe0 leur famille. Cette r\xe9f\xe9rence, par convention, sera l\u2019id de\nla famille."),(0,t.mdx)("p",null,"Voici les \xe9tapes que l\u2019on va suivre :"),(0,t.mdx)("ol",null,(0,t.mdx)("li",{parentName:"ol"},"Ajout du champ famille_id sur les aliments."),(0,t.mdx)("li",{parentName:"ol"},"Modification de ce champ pour signaler \xe0 MySQL que c\u2019est une ",(0,t.mdx)("strong",{parentName:"li"},"r\xe9f\xe9rence")," \xe0 la table famille."),(0,t.mdx)("li",{parentName:"ol"},"Modification d\u2019un objet pour y stocker une relation.")),(0,t.mdx)("p",null,"Concernant l\u2019ajout du champ famille_id aux aliments, vous devriez vous en sortir seul. \ud83d\ude09"),(0,t.mdx)("p",null,"C\u2019est une cl\xe9 primaire (un id), vous commencez \xe0 bien les conna\xeetre. Et pour ajouter un champ \xe0 un sch\xe9ma, vous venez juste de le voir dans le\nchapitre pr\xe9c\xe9dent !"),(0,t.mdx)("p",null,"Au cas o\xf9, voici la commande :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment\nADD famille_id INT NOT NULL;\n")),(0,t.mdx)("p",null,"Ensuite, \xe7a se complique. Il faut qu\u2019on indique \xe0 MySQL que ce champ est une ",(0,t.mdx)("strong",{parentName:"p"},"r\xe9f\xe9rence")," \xe0 une autre table, en lui pr\xe9cisant quel champ de\ncette autre table on r\xe9f\xe9rence."),(0,t.mdx)("p",null,"Pour modifier le champ famille_id, on utilise la commande :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"ALTER TABLE aliment\nADD FOREIGN KEY (famille_id) REFERENCES famille (id)\nON DELETE CASCADE;\n")),(0,t.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Houl\xe0, \xe7a fait peur \ud83d\ude28"))),(0,t.mdx)("p",null,"Voyons ensemble ce que cette commande signifie :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"La premi\xe8re partie, vous la connaissez. \ud83d\ude09 On signale \xe0 MySQL qu\u2019on souhaite modifier la table \u201caliment\u201d, pour y ajouter une colonne (enfin,\nplut\xf4t y ajouter une contrainte, dans ce cas pr\xe9cis)."),(0,t.mdx)("li",{parentName:"ul"},"On dit \xe0 MySQL que la colonne \u201cfamille_id\u201d est ",(0,t.mdx)("strong",{parentName:"li"},"une cl\xe9 \xe9trang\xe8re")," (",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("em",{parentName:"strong"},"foreign key"))," en anglais), soit une r\xe9f\xe9rence \xe0 une colonne d\u2019une\nautre table (ici, avec la partie ",(0,t.mdx)("inlineCode",{parentName:"li"},"FOREIGN KEY (famille_id)"),")."),(0,t.mdx)("li",{parentName:"ul"},"On indique ensuite ",(0,t.mdx)("strong",{parentName:"li"},"ce \xe0 quoi cette cl\xe9 fait r\xe9f\xe9rence"),". Soit, dans notre cas, la colonne \u201cid\u201d de la table \u201cfamille\u201d (soit la commande\n",(0,t.mdx)("inlineCode",{parentName:"li"},"REFERENCES famille(id)"),")."),(0,t.mdx)("li",{parentName:"ul"},"Enfin, s\xfbrement la partie la plus obscure pour vous, on indique \xe0 MySQL ",(0,t.mdx)("strong",{parentName:"li"},"le comportement \xe0 adopter en cas de suppression")," de l\u2019objet\n\u201cunique\u201d (ici, la \u201cfamille\u201d).")),(0,t.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"H\xe9, mais je n\u2019ai rien compris au dernier point !"))),(0,t.mdx)("p",null,"Laissez-moi vous expliquer. \ud83e\udd14"),(0,t.mdx)("p",null,"Admettons que je vienne de cr\xe9er ma famille \u201cfruits\u201d, et qu\u2019elle soit reli\xe9e \xe0 mes objets \u201cpomme\u201d et \u201cpoire\u201d."),(0,t.mdx)("p",null,"Que se passe-t-il si je supprime la famille \u201cfruits\u201d ?"),(0,t.mdx)("p",null,"Eh bien, MySQL a besoin de le savoir. Pour cela, on lui indique via la commande ",(0,t.mdx)("strong",{parentName:"p"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ON DELETE")),"."),(0,t.mdx)("p",null,"Cette derni\xe8re peut prendre une option parmi celles-ci :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"RESTRICT"))," ou ",(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"NO ACTION"))," : MySQL va emp\xeacher la suppression tant que \u201cfruits\u201d est r\xe9f\xe9renc\xe9 sur au moins un objet \u201caliment\u201d."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"SET NULL"))," : MySQL va autoriser la suppression de \u201cfruits\u201d, et remplacer \u201cfamille_id\u201d sur \u201cpomme\u201d et \u201cpoire\u201d par la valeur NULL."),(0,t.mdx)("li",{parentName:"ul"},(0,t.mdx)("strong",{parentName:"li"},(0,t.mdx)("inlineCode",{parentName:"strong"},"CASCADE"))," : l\u2019option la plus courante, mais la plus dangereuse. \ud83d\ude28 Ici, MySQL va supprimer \u201cpoire\u201d et \u201cpomme\u201d en m\xeame temps que \u201cfruits\u201d\n(il va donc supprimer tous les objets reli\xe9s).")),(0,t.mdx)("figure",null,(0,t.mdx)("img",{src:"https://user.oc-static.com/upload/2021/01/18/1610964972865_P4_ON-DELETE.png",alt:"R\xe9capitulatif visuel du paragraphe r\xe9dig\xe9 ci-dessus"}),(0,t.mdx)("figcaption",null,"Actions de la commande ON DELETE")),(0,t.mdx)("p",null,"Voil\xe0, MySQL sait que \u201cfamille_id\u201d est une r\xe9f\xe9rence \xe0 l\u2019id de la table famille !"),(0,t.mdx)("p",null,"Reste maintenant \xe0 mettre \xe0 jour vos aliments !"),(0,t.mdx)("p",null,"Pareil ici, vous avez toutes les comp\xe9tences en main pour le faire. Sauriez-vous par exemple ajouter la relation de l\u2019objet \u201charicots verts\u201d\nvers la famille \u201cl\xe9gumes\u201d ?"),(0,t.mdx)("p",null,"Voici la commande :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"UPDATE `aliment` SET `famille_id` = '1' WHERE `nom` = 'haricots verts';\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"N\u2019oubliez pas, \u201cl\xe9gumes\u201d ayant \xe9t\xe9 ajout\xe9 en premier \xe0 la table \u201cfamille\u201d, il a l\u2019id num\xe9ro 1. Si vous \xeates perdu, ",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142248-inserez-des-donnees-dans-votre-bdd"},"relisez la partie 2")," !"))),(0,t.mdx)("p",null,"Pour v\xe9rifier que cela a bien fonctionn\xe9, vous pouvez s\xe9lectionner les haricots verts avec leur famille gr\xe2ce \xe0 un ",(0,t.mdx)("strong",{parentName:"p"},"JOIN"),"."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},'SELECT * FROM aliment\nJOIN famille ON aliment.famille_id = famille.id\nWHERE aliment.nom = "haricots verts";\n')),(0,t.mdx)("p",null,"Gr\xe2ce \xe0 cette commande, vous verrez appara\xeetre un tableau r\xe9capitulatif, o\xf9 la famille de \u201charicots verts\u201d est bien \u201cl\xe9gumes\u201d."),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Perdu \xe0 nouveau ? Ne vous inqui\xe9tez pas, ",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142285-implementez-des-relations-entre-vos-donnees-grace-a-join"},"relisez le chapitre 3 de la partie pr\xe9c\xe9dente"),",\nsur la commande ",(0,t.mdx)("inlineCode",{parentName:"p"},"JOIN"),"."))),(0,t.mdx)("p",null,"Il ne vous reste plus qu\u2019\xe0 ajouter les autres familles vous-m\xeame, rajouter sa famille \xe0 chaque aliment, et le tour est jou\xe9 !"),(0,t.mdx)("p",null,"Pour ce faire, vous n\u2019avez qu\u2019\xe0 r\xe9effectuer les commandes pr\xe9c\xe9dentes en les adaptant. C\u2019est un super moyen de revoir tout ce que vous avez pu\napprendre lors de ce cours !"),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer--4"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"Faisons un petit exercice :"),(0,t.mdx)("p",null,"On souhaite rajouter les r\xe9ductions disponibles sur les aliments. Une r\xe9duction pouvant \xeatre la m\xeame pour plusieurs aliments mais chaque\naliment pouvant n\u2019avoir qu\u2019une seule r\xe9duction, il s\u2019agit d\u2019une relation un \xe0 plusieurs."),(0,t.mdx)("p",null,"Les r\xe9ductions sont uniquement constitu\xe9es d\u2019un champ \u201cvaleur\u201d, qui va contenir la r\xe9duction au format texte."),(0,t.mdx)("p",null,"Comment feriez-vous pour cr\xe9er cette table et la lier aux aliments ?"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> CREATE TABLE reduction (\n    -> id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    -> valeur VARCHAR(100) NOT NULL\n    -> );\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> INSERT INTO reduction (valeur) VALUES ('-30%');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> INSERT INTO reduction (valeur) VALUES ('-50%');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> SELECT * FROM reduction;\n+----+--------+\n| id | valeur |\n+----+--------+\n|  1 | -30%   |\n|  2 | -50%   |\n+----+--------+\n2 rows in set (0.00 sec)\n\nmysql> ALTER TABLE aliment ADD reduction_id INT;\nQuery OK, 0 rows affected (0.01 sec)\nRecords: 0 Duplicates: 0 Warnings: 0\n\nmysql> ALTER TABLE aliment ADD FOREIGN KEY (reduction_id) REFERENCES reduction (id) ON DELETE SET NULL;\nQuery OK, 20 rows affected (0.02 sec)\nRecords: 20 Duplicates: 0 Warnings: 0\n\nmysql> SELECT * FROM aliment WHERE id=1;\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n| id | nom   | marque      | sucre | calories | graisses | proteines | bio  | reduction_id |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n|  1 | pomme | sans marque |  19.1 |       72 |      0.2 |       0.4 |    0 |         NULL |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n1 row in set (0.00 sec)\n\nmysql> UPDATE aliment SET reduction_id = 1 WHERE id = 1;\nQuery OK, 1 rows affected (0.01 sec)\nRows matched: 1 Changed: 1 Warnings: 0\n\nmysql> SELECT * FROM aliment WHERE id=1;\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n| id | nom   | marque      | sucre | calories | graisses | proteines | bio  | reduction_id |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n|  1 | pomme | sans marque |  19.1 |       72 |      0.2 |       0.4 |    0 |            1 |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+\n1 row in set (0.00 sec)\n\nmysql> SELECT * from aliment\n    -> JOIN reduction\n    -> ON aliment.reduction_id = reduction.id\n    -> WHERE aliment.id = 1;\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+----+--------+\n| id | nom   | marque      | sucre | calories | graisses | proteines | bio  | reduction_id | id | valeur |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+----+--------+\n|  1 | pomme | sans marque |  19.1 |       72 |      0.2 |       0.4 |    0 |            1 |  1 | -30%   |\n+----+-------+-------------+-------+----------+----------+-----------+------+--------------+----+--------+\n1 row in set (0.00 sec)\n")),(0,t.mdx)("p",null,"Je vous laisse faire, vous en \xeates capable. \ud83d\udcaa Une fois essay\xe9, voici la correction :"),(0,t.mdx)(s.fG,{vimeoId:"497578418",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("h3",{id:"en-r\xe9sum\xe9-1"},"En r\xe9sum\xe9"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"Vous savez ajouter une relation un \xe0 plusieurs entre deux objets en ",(0,t.mdx)("strong",{parentName:"li"},"ajoutant")," \xe0 l\u2019objet A ",(0,t.mdx)("strong",{parentName:"li"},"un champ qui contiendra l\u2019id")," (ou cl\xe9 primaire)\nde l\u2019objet B.")),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Voyons au chapitre suivant comment ajouter un relation plusieurs \xe0 plusieurs entre deux objets.")),(0,t.mdx)("hr",null),(0,t.mdx)("h2",{id:"ajoutez-une-relation-plusieurs-\xe0-plusieurs"},"Ajoutez une relation plusieurs \xe0 plusieurs"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7153111-ajoutez-une-relation-plusieurs-a-plusieurs"},"Ajoutez une relation plusieurs \xe0 plusieurs - Impl\xe9mentez vos bases de donn\xe9es relationnelles avec SQL - OpenClassrooms")),(0,t.mdx)("p",null,(0,t.mdx)("img",{parentName:"p",src:"https://user.oc-static.com/upload/2021/01/26/16116831263516_BANNERS_%20P4C3.png",alt:null})),(0,t.mdx)("p",null,'Vous avez cr\xe9\xe9 votre nouvelle table "famille" ? Souvenez-vous on aimerait ensuite ajouter le type de magasin o\xf9 sont pr\xe9sents les aliments. Un\nm\xeame aliment pouvant \xeatre pr\xe9sent dans plusieurs lieux, nous allons cr\xe9er une relation plusieurs \xe0 plusieurs. Voyons comment faire !'),(0,t.mdx)("h3",{id:"ajoutez-une-nouvelle-table-lieu"},"Ajoutez une nouvelle table \u201clieu\u201d"),(0,t.mdx)("p",null,"La derni\xe8re demande de mise \xe0 jour des utilisateurs est arriv\xe9e !"),(0,t.mdx)("p",null,"Ces derniers r\xe9clament une chose en th\xe9orie simple : pouvoir visualiser dans l\u2019application de Foodly dans quel magasin sont disponibles leurs\naliments pr\xe9f\xe9r\xe9s. Par exemple, savoir si leur jambon de pr\xe9dilection est disponible aussi bien \xe0 Carrefour que chez Leclerc."),(0,t.mdx)("p",null,"Les d\xe9veloppeurs se sont de nouveau regroup\xe9s : il va falloir stocker les ",(0,t.mdx)("strong",{parentName:"p"},"lieux de vente")," dans la BDD."),(0,t.mdx)("p",null,"Un lieu pouvant vendre plusieurs aliments, et ces m\xeames aliments pouvant \xeatre vendus dans plusieurs lieux, vous allez devoir cr\xe9er une\n",(0,t.mdx)("strong",{parentName:"p"},"relation plusieurs \xe0 plusieurs"),"."),(0,t.mdx)("p",null,"Mais avant toute chose, il vous faut cr\xe9er la nouvelle table des lieux de vente (que nous allons sobrement appeler \u201clieu\u201d)."),(0,t.mdx)("p",null,"Un lieu de vente, c\u2019est :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"un nom (exemple : Carrefour City) ;"),(0,t.mdx)("li",{parentName:"ul"},"un type (exemple : supermarch\xe9).")),(0,t.mdx)("p",null,"Je vous laisse cr\xe9er la table vous-m\xeame ? Apr\xe8s tout, vous avez toutes les cartes en main pour le faire !"),(0,t.mdx)("p",null,"Allez-y, je vous attends. \ud83d\ude09"),(0,t.mdx)("p",null,"Bon, allez, au cas o\xf9, voici la correction :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE lieu (\nid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\nnom VARCHAR(100) NOT NULL,\ntype VARCHAR(100) NOT NULL\n);\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous \xeates perdu face \xe0 cette commande ? Revoyez la ",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7139618-installez-votre-systeme-de-gestion-de-base-de-donnees-sgbd"},"partie 1 du cours")," !"))),(0,t.mdx)("p",null,"OK, une fois la table cr\xe9\xe9e, ins\xe9rons un lieu dans cette derni\xe8re, partons sur un simple Carrefour City (oui, \xe7a se sent que je suis citadin ? \ud83d\ude06)."),(0,t.mdx)("p",null,"Pareil ici, vous devriez pouvoir \xe9crire cette commande vous-m\xeame, j\u2019en suis s\xfbr. \ud83d\ude4c"),(0,t.mdx)("p",null,"Au cas o\xf9, voici la correction :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO `lieu` (`nom`, `type`) VALUES ('Carrefour City', 'supermarch\xe9');\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous n\u2019\xeates pas s\xfbr de ce que cette commande signifie ? Relisez la partie 2 du cours !"))),(0,t.mdx)("p",null,"\xc7a y est, la nouvelle table est cr\xe9\xe9e, et un objet y a \xe9t\xe9 ins\xe9r\xe9. Passons maintenant aux choses s\xe9rieuses en cr\xe9ant la relation plusieurs \xe0\nplusieurs avec les aliments."),(0,t.mdx)("h3",{id:"ajoutez-la-table-de-liaison"},"Ajoutez la table de liaison"),(0,t.mdx)("p",null,"Si vous vous souvenez de la partie 3, vous savez que MySQL (et les bases de donn\xe9es SQL en g\xe9n\xe9ral) ne savent techniquement pas stocker autre\nchose que des relations un \xe0 plusieurs."),(0,t.mdx)("p",null,"Pour les relations plusieurs \xe0 plusieurs, on \u201ctriche\u201d, via une ",(0,t.mdx)("strong",{parentName:"p"},"table de liaison")," o\xf9 on va stocker chaque relation, comme si c\u2019\xe9tait une\ndouble relation un \xe0 plusieurs."),(0,t.mdx)("p",null,"En fait, les aliments vont avoir des relations un \xe0 plusieurs avec la table de liaison. Les lieux, eux aussi, vont disposer de telles relations\navec cette table. Et c\u2019est en ",(0,t.mdx)("strong",{parentName:"p"},"reliant ces deux tables via cette table de liaison")," que vous allez pouvoir ressortir les relations entre lieux\net aliments."),(0,t.mdx)("p",null,"Pour ce faire, une table de liaison doit \xeatre cr\xe9\xe9e. Par convention, elle doit toujours avoir cette forme :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"Son nom doit regrouper les deux tables qu\u2019elle relie, sous la forme : \u201ctable1_table2\u201d."),(0,t.mdx)("li",{parentName:"ul"},"Elle n\u2019a que deux champs \xe0 stocker : \u201ctable1_id\u201d et \u201ctable2_id\u201d. Soit les id de chaque objet qu\u2019elle relie.",(0,t.mdx)("ul",{parentName:"li"},(0,t.mdx)("li",{parentName:"ul"},"Ces id sont donc des ",(0,t.mdx)("strong",{parentName:"li"},"r\xe9f\xe9rences")," aux id des autres tables."))),(0,t.mdx)("li",{parentName:"ul"},"Sa cl\xe9 primaire n\u2019est autre que l\u2019association de ces deux id (association qui doit toujours \xeatre unique).")),(0,t.mdx)("p",null,"Dans notre cas, cela donne ceci en commande SQL :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE aliment_lieu (\naliment_id INT NOT NULL,\nlieu_id INT NOT NULL,\nFOREIGN KEY (aliment_id) REFERENCES aliment (id) ON DELETE RESTRICT ON UPDATE CASCADE,\nFOREIGN KEY (lieu_id) REFERENCES lieu (id) ON DELETE RESTRICT ON UPDATE CASCADE,\nPRIMARY KEY (aliment_id, lieu_id)\n);\n")),(0,t.mdx)("p",null,"D\xe9cortiquons cette commande ensemble :"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"On ",(0,t.mdx)("strong",{parentName:"li"},"cr\xe9e une nouvelle table")," avec le nom des deux tables qu\u2019elle relie (ici la table \u201caliment\u201d, ainsi que la table \u201clieu\u201d)."),(0,t.mdx)("li",{parentName:"ul"},"On ",(0,t.mdx)("strong",{parentName:"li"},"ajoute les r\xe9f\xe9rences")," aux id de ces deux tables :",(0,t.mdx)("ul",{parentName:"li"},(0,t.mdx)("li",{parentName:"ul"},"\u201caliment_id\u201d, qui est une r\xe9f\xe9rence aux id de la table \u201caliment\u201d ;"),(0,t.mdx)("li",{parentName:"ul"},"\u201clieu_id\u201d, qui est une r\xe9f\xe9rence aux id de la table \u201clieu\u201d ;"),(0,t.mdx)("li",{parentName:"ul"},"on signale \xe0 MySQL ",(0,t.mdx)("strong",{parentName:"li"},"comment mettre \xe0 jour")," la BDD en cas de suppression ou de mise \xe0 jour d\u2019un objet de \u201caliment_lieu\u201d."))),(0,t.mdx)("li",{parentName:"ul"},"On explique \xe0 MySQL que l\u2019id de cette table sera l\u2019association entre les deux id pr\xe9c\xe9dents.")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Vous vous demandez ce que signifie ",(0,t.mdx)("strong",{parentName:"p"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ON UPDATE"))," ? Eh bien, c\u2019est le comportement que doit adopter MySQL en cas de ",(0,t.mdx)("strong",{parentName:"p"},"mise \xe0 jour")," d\u2019un champ.\nIl peut avoir les m\xeames options que ",(0,t.mdx)("strong",{parentName:"p"},(0,t.mdx)("inlineCode",{parentName:"strong"},"ON DELETE")),", que vous avez vu dans le chapitre pr\xe9c\xe9dent. \ud83d\ude09"))),(0,t.mdx)("figure",null,(0,t.mdx)("img",{src:"https://user.oc-static.com/upload/2021/01/18/16109652325493_P4_ON-UPDATE.png",alt:"R\xe9capitulatif visuel de la commande. RESTRICT ou NO ACTION : emp\xeache la mise \xe0 jour sous conditions. SET NULL : met \xe0 jour la famille et remplace les object par NULL. CASCADE : met \xe0 jour tous les objets reli\xe9s"}),(0,t.mdx)("figcaption",null,"Actions de la commande ON UPDATE")),(0,t.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"C\u2019est bien beau tout \xe7a, mais comment ajoute-t-on une relation entre les lieux et les aliments ?"))),(0,t.mdx)("p",null,"Pas de panique, \xe7a arrive !"),(0,t.mdx)("p",null,"Admettons que le \u201cblanc de dinde\u201d pr\xe9sent dans notre BDD soit vendu chez \u201cCarrefour City\u201d. Il vous faudrait alors cr\xe9er un objet dans\n\u201caliment_lieu\u201d, avec l\u2019id de \u201cblanc de dinde\u201d ainsi que l\u2019id de \u201cCarrefour City\u201d."),(0,t.mdx)("p",null,"Retrouvez ces id dans votre BDD et \xe9crivez la commande SQL pour cr\xe9er cette relation."),(0,t.mdx)("p",null,"Sachant que 11 est l\u2019id du \u201cblanc de dinde\u201d, 1 celui du \u201cCarrefour City\u201d, cela donne \xe7a :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO `aliment_lieu` (`aliment_id`, `lieu_id`) VALUES ('11', '1');\n")),(0,t.mdx)("p",null,"Et voil\xe0, le fait que le blanc de dinde soit vendu \xe0 Carrefour est stock\xe9 en base de donn\xe9es. Bravo \xe0 vous. \ud83d\udc4f"),(0,t.mdx)("p",null,"Enfin, pour retrouver cette relation, il vous faudra faire un ",(0,t.mdx)("strong",{parentName:"p"},"double JOIN"),". Rappelez-vous, nous avions vu \xe7a ensemble dans\n",(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142248-inserez-des-donnees-dans-votre-bdd"},"la partie 2"),"."),(0,t.mdx)("p",null,"Cela ressemble \xe0 \xe7a :"),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM aliment\nJOIN aliment_lieu ON aliment.id = aliment_lieu.aliment_id\nJOIN lieu ON lieu.id = aliment_lieu.lieu_id\nWHERE aliment.id = 11;\n")),(0,t.mdx)("div",{className:"admonition admonition-info alert alert--info"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Ici, on joint la table aliment \xe0 la table lieu ",(0,t.mdx)("strong",{parentName:"p"},"via")," la table de liaison, comme si c\u2019\xe9tait une simple relation un \xe0 plusieurs r\xe9p\xe9t\xe9e."))),(0,t.mdx)("p",null,"En sortie, MySQL vous affichera bien le \u201cblanc de dinde\u201d avec son lieu de vente associ\xe9 : \u201cCarrefour City\u201d !"),(0,t.mdx)("h3",{id:"\xe0-vous-de-jouer--5"},"\xc0 vous de jouer !"),(0,t.mdx)("p",null,"On souhaite savoir quels sont les appareils sur lesquels les utilisateurs ont install\xe9 Foodly (par exemple : mac, pc, android, etc.)."),(0,t.mdx)("p",null,"Un utilisateur peut utiliser Foodly sur plusieurs appareils, et un m\xeame appareil peut \xeatre commun \xe0 plusieurs utilisateurs. Il s\u2019agit d\u2019une\nrelation plusieurs \xe0 plusieurs."),(0,t.mdx)("p",null,"Un appareil est uniquement constitu\xe9 de son type au format texte."),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"mysql> CREATE TABLE appareil (\n    -> id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    -> type VARCHAR(100) NOT NULL\n    -> );\nQuery OK, 0 rows affeected (0.01 sec)\n\nmysql> INSERT INTO appareil (type) VALUES ('iphone');\nQuery OK, 1 rows affeected (0.00 sec)\n\nmysql> INSERT INTO appareil (type) VALUES ('android');\nQuery OK, 1 rows affeected (0.00 sec)\n\nmysql> INSERT INTO appareil (type) VALUES ('pc');\nQuery OK, 1 rows affeected (0.00 sec)\n\nmysql> INSERT INTO appareil (type) VALUES ('mac');\nQuery OK, 1 rows affeected (0.00 sec)\n\nmysql> SELECT * FROM appareil;\n+----+---------+\n| id | type    |\n+----+---------+\n|  1 | iphone  |\n|  2 | android |\n|  3 | pc      |\n|  4 | mac     |\n+----+---------+\n4 rows in set (0.00 sec)\n\nmysql> CREATE TABLE utilisateur_appareil (\n    -> utilisateur_id INT NOT NULL,\n    -> appareil_id INT NOT NULL,\n    -> FOREIGN KEY (utilisateur_id) REFERENCES utilisateur (id) ON DELETE RESTRICT ON UPDATE CASCADE,\n    -> FOREIGN KEY (appareil_id) REFERENCES appareil (id) ON DELETE RESTRICT ON UPDATE CASCADE,\n    -> PRIMARY KEY (utilisateur_id, appareil_id)\n    -> );\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> SELECT * FROM utilisateur_appareil;\nEmpty set (0.00 sec)\n\nmysql> SELECT * FROM utilisateur WHERE id = 1;\n+----+---------+------------------+-----------+\n| id | prenom  | email            | langue_id |\n+----+---------+------------------+-----------+\n|  1 | quentin | qentin@gmail.com |         1 |\n+----+---------+------------------+-----------+\n1 row in set (0.00 sec)\n\nmysql> INSERT INTO utilisateur_appareil (utilisateur_id, appareil_id) VALUES (1, 2);\nQuery OK, 1 rows affected (0.01 sec)\n\nmysql> INSERT INTO utilisateur_appareil (utilisateur_id, appareil_id) VALUES (1, 4);\nQuery OK, 1 rows affected (0.01 sec)\n\nmysql> SELECT * FROM utilisateur_appareil;\n+----------------+-------------+\n| utilisateur_id | appareil_id |\n+----------------+-------------+\n|              1 |           2 |\n|              1 |           4 |\n+----------------+-------------+\n2 row in set (0.00 sec)\n\nmysql> SELECT * FROM utilisateur\n    -> JOIN utilisateur_appareil\n    -> ON utilisateur.id = utilisateur_appareil.utilisateur_id\n    -> JOIN appareil\n    -> ON appareil.id = utilisateur_appareil.appareil_id\n    -> WHERE utilisateur.id = 1;\n+----+---------+------------------+-----------+----------------+-------------+----+---------+\n| id | prenom  | email            | langue_id | utilisateur_id | appareil_id | id | type    |\n+----+---------+------------------+-----------+----------------+-------------+----+---------+\n|  1 | quentin | qentin@gmail.com |         1 |              1 |           2 |  2 | android |\n|  1 | quentin | qentin@gmail.com |         1 |              1 |           4 |  4 | mac     |\n+----+---------+------------------+-----------+----------------+-------------+----+---------+\n2 row in set (0.00 sec)\n")),(0,t.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,t.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,t.mdx)("h5",{parentName:"div"},(0,t.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,t.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,t.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"?")),(0,t.mdx)("div",{parentName:"div",className:"admonition-content"},(0,t.mdx)("p",{parentName:"div"},"Comment feriez-vous pour cr\xe9er cette table et la lier aux utilisateurs ?"))),(0,t.mdx)("p",null,"Je crois en vous pour effectuer cette op\xe9ration seul \ud83d\ude4c Si vous \xeates bloqu\xe9, la correction est disponible ici :"),(0,t.mdx)(s.fG,{vimeoId:"497578465",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("h3",{id:"en-r\xe9sum\xe9-2"},"En r\xe9sum\xe9"),(0,t.mdx)("ul",null,(0,t.mdx)("li",{parentName:"ul"},"Vous savez ajouter une relation plusieurs \xe0 plusieurs entre deux objets ",(0,t.mdx)("strong",{parentName:"li"},"en cr\xe9ant une table de liaison")," qui ",(0,t.mdx)("strong",{parentName:"li"},"contiendra les id de chaque\nobjet"),".")),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Vous voil\xe0 arriv\xe9 \xe0 la fin de ce cours. Retrouvez-moi au chapitre suivant pour la conclusion !")),(0,t.mdx)("hr",null),(0,t.mdx)("h2",{id:"terminez-votre-apprentissage"},"Terminez votre apprentissage"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/7142305-terminez-votre-apprentissage"},"Terminez votre apprentissage - Impl\xe9mentez vos bases de donn\xe9es relationnelles avec SQL - OpenClassrooms")),(0,t.mdx)(s.fG,{vimeoId:"497953156",mdxType:"Vimeo"}),(0,t.mdx)("br",null),(0,t.mdx)("p",null,"Vous voici \xe0 la conclusion de ce cours, bravo ! \ud83d\udc4f Il ne vous reste plus qu'un dernier effort avec la r\xe9alisation du dernier quiz."),(0,t.mdx)("p",null,"Vous avez normalement toutes les bases en main pour impl\xe9menter votre propre BDD. Que ce soit pour un projet personnel, le travail, ou par\nsimple curiosit\xe9, j\u2019esp\xe8re de tout c\u0153ur que ce cours vous aura \xe9t\xe9 utile."),(0,t.mdx)("p",null,"J\u2019ai personnellement ador\xe9 \xe9crire ce cours, qui m\u2019a moi-m\xeame \xe9t\xe9 d\u2019une grande aide pour me remettre dans le bain des BDD relationnelles !"),(0,t.mdx)("p",null,"Je vous souhaite tout le meilleur pour la suite, et n\u2019oubliez pas, continuez d\u2019apprendre de nouvelles choses sur OpenClassrooms !"),(0,t.mdx)("hr",null),(0,t.mdx)("h2",{id:"quiz--transformez-la-structure-dune-base-de-donn\xe9es"},"Quiz : Transformez la structure d\u2019une base de donn\xe9es"),(0,t.mdx)("p",null,(0,t.mdx)("a",{parentName:"p",href:"https://openclassrooms.com/fr/courses/6971126-implementez-vos-bases-de-donnees-relationnelles-avec-sql/exercises/4010"},"Transformez la structure d\u2019une base de donn\xe9es - OpenClassrooms")),(0,t.mdx)("h4",{id:"comp\xe9tences-\xe9valu\xe9es"},"Comp\xe9tences \xe9valu\xe9es"),(0,t.mdx)("i",{class:"bi bi-check2-circle"})," Transformer la structure d\u2019une base de donn\xe9es",(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"description"},"Description"),(0,t.mdx)("p",null,"Reprenons notre BDD Moviz du pr\xe9c\xe9dent quiz. Vous pouvez la t\xe9l\xe9charger ici : ",(0,t.mdx)("a",{parentName:"p",href:"https://github.com/OpenClassrooms-Student-Center/Course-implementez-BDD-SQL/blob/master/partie_4/moviz.sql"},"https://github.com/OpenClassrooms-Student-Center/Course-implementez-BDD-SQL/blob/master/partie","_","4/moviz.sql"),"."),(0,t.mdx)("p",null,"Souvenez-vous, j\u2019ai modifi\xe9 le sch\xe9ma de la BDD entre la partie 2 et la partie 3 pour y ajouter la relation un \xe0 plusieurs entre \u201cfilm\u201d et\n\u201cnote\u201d, ainsi que la relation plusieurs \xe0 plusieurs entre \u201cfilm\u201d et \u201cpays_de_sortie\u201d."),(0,t.mdx)("p",null,"Dans ce quiz, nous allons faire comme si vous impl\xe9mentiez vous-m\xeame ces changements."),(0,t.mdx)("p",null,"Pour rappel, voici le sch\xe9ma mis \xe0 jour de la table \u201cfilm\u201d :"),(0,t.mdx)("table",null,(0,t.mdx)("thead",{parentName:"table"},(0,t.mdx)("tr",{parentName:"thead"},(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Nom du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Type du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Description du champ")))),(0,t.mdx)("tbody",{parentName:"table"},(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"nom")),(0,t.mdx)("td",{parentName:"tr",align:null},"VARCHAR(255)"),(0,t.mdx)("td",{parentName:"tr",align:null},"le nom du film")),(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"date_de_sortie")),(0,t.mdx)("td",{parentName:"tr",align:null},"DATE"),(0,t.mdx)("td",{parentName:"tr",align:null},"la date de sortie du film")),(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"synopsis")),(0,t.mdx)("td",{parentName:"tr",align:null},"TEXT"),(0,t.mdx)("td",{parentName:"tr",align:null},"la description du sc\xe9nario du film")),(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"langue")),(0,t.mdx)("td",{parentName:"tr",align:null},"VARCHAR(255)"),(0,t.mdx)("td",{parentName:"tr",align:null},"la langue principale du film")),(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"budget")),(0,t.mdx)("td",{parentName:"tr",align:null},"INTEGER"),(0,t.mdx)("td",{parentName:"tr",align:null},"le budget de production du film")),(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},"note_id"),(0,t.mdx)("td",{parentName:"tr",align:null},"INTEGER"),(0,t.mdx)("td",{parentName:"tr",align:null},"l'id de l'objet note associ\xe9 au film")))),(0,t.mdx)("p",null,"Le sch\xe9ma de la table \u201cnote\u201d est disponible ici :"),(0,t.mdx)("table",null,(0,t.mdx)("thead",{parentName:"table"},(0,t.mdx)("tr",{parentName:"thead"},(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Nom du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Type du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Description du champ")))),(0,t.mdx)("tbody",{parentName:"table"},(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"note")),(0,t.mdx)("td",{parentName:"tr",align:null},"INTEGER"),(0,t.mdx)("td",{parentName:"tr",align:null},"la note sur 5")))),(0,t.mdx)("p",null,"Et enfin, voici le sch\xe9ma de \u201cpays_de_sortie\u201d :"),(0,t.mdx)("table",null,(0,t.mdx)("thead",{parentName:"table"},(0,t.mdx)("tr",{parentName:"thead"},(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Nom du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Type du champ")),(0,t.mdx)("th",{parentName:"tr",align:null},(0,t.mdx)("strong",{parentName:"th"},"Description du champ")))),(0,t.mdx)("tbody",{parentName:"table"},(0,t.mdx)("tr",{parentName:"tbody"},(0,t.mdx)("td",{parentName:"tr",align:null},(0,t.mdx)("em",{parentName:"td"},"nom")),(0,t.mdx)("td",{parentName:"tr",align:null},"VARCHAR(255)"),(0,t.mdx)("td",{parentName:"tr",align:null},"le nom du pays")))),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-1--quels-sont-les-mots-cl\xe9s-disponibles-dans-une-commande-de-type-alter-table-"},"Question 1 : Quels sont les mots cl\xe9s disponibles dans une commande de type ALTER TABLE ?"),(0,t.mdx)("i",{class:"bi bi-record-circle"})," ADD, DROP, CHANGE, MODIFY",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," AJOUTER, SUPPRIMER, MODIFIER",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ADD, DROP, CHANGE",(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"ALTER TABLE sert \xe0 modifier la structure d\u2019un objet, et de la table associ\xe9e. ADD permet d\u2019ajouter un champ, DROP de le supprimer, CHANGE de\nle renommer, MODIFY de modifier son type.")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-2--comment-fait-on-pour-ajouter-une-relation-un-\xe0-plusieurs-entre-deux-objets-existants-d\xe9j\xe0-en-base-"},"Question 2 : Comment fait-on pour ajouter une relation un \xe0 plusieurs entre deux objets existants d\xe9j\xe0 en base ?"),(0,t.mdx)("i",{class:"bi bi-record-circle"})," On rajoute l\u2019id de l\u2019objet \u201cun\u201d comme colonne dans l\u2019objet \u201cplusieurs\u201d avec comme nom \u201cobjet_id\u201d.",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," On utilise une commande SQL avec le mot cl\xe9 JOIN.",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," On supprime et recr\xe9e les deux objets.",(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Pour effectuer une relation un \xe0 plusieurs, l\u2019objet \u201cun\u201d de la relation doit \xeatre mentionn\xe9 dans l\u2019objet \u201cplusieurs\u201d. La convention en SQL\nest de reprendre son id (sa cl\xe9 primaire) comme cl\xe9 \xe9trang\xe8re dans l\u2019objet plusieurs.")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-3--dans-la-bdd-moviz-quelle-est-la-commande-qui-permet-de-rajouter-le-champ-note_id-\xe0-la-table-film-"},"Question 3 : Dans la BDD Moviz, quelle est la commande qui permet de rajouter le champ \u201cnote_id\u201d \xe0 la table \u201cfilm\u201d ?"),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film ADD note_id;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-record-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film ADD note_id INTEGER NOT NULL;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film ADD note_id VARCHAR(100);"),(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Pour ajouter un champ \xe0 un objet (et donc, \xe0 sa table), on utilise une commande de type ALTER TABLE avec le mot cl\xe9 ADD. Comme on souhaite\najouter un champ qui sera une cl\xe9 \xe9trang\xe8re, il est du m\xeame type qu\u2019une cl\xe9 primaire, soit un entier (INTEGER) non nul (NOT NULL).")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-4--quelle-est-la-commande-qui-permet-de-supprimer-le-budget-sur-les-films-"},"Question 4 : Quelle est la commande qui permet de supprimer le budget sur les films ?"),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film REMOVE budget;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-record-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film DROP budget;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film DELETE budget;"),(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Pour supprimer un champ \xe0 un objet (et donc, \xe0 sa table), on utilise une commande de type ALTER TABLE avec le mot cl\xe9 DROP suivi du nom du\nchamp \xe0 supprimer.")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-5--quelle-est-la-commande-qui-permet-de-modifier-le-type-du-champ-budget-dentier-vers-d\xe9cimal-"},"Question 5 : Quelle est la commande qui permet de modifier le type du champ \u201cbudget\u201d d\u2019entier vers d\xe9cimal ?"),(0,t.mdx)("i",{class:"bi bi-record-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film MODIFY budget FLOAT;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film MODIFY budget VARCHAR(100);"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film CHANGE budget FLOAT;"),(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Pour modifier le type d\u2019un champ, on utilise une commande de type ALTER TABLE avec le mot cl\xe9 MODIFY suivi du nom du champ et de son nouveau\ntype (ici, d\xe9cimal, soit FLOAT).")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-6--quelle-est-la-commande-qui-permet-de-renommer-le-budget-sur-les-films-en-cout_de_production-"},"Question 6 : Quelle est la commande qui permet de renommer le budget sur les films en \u201ccout_de_production\u201d ?"),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film CHANGE budget cout_de_production;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-record-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film CHANGE budget cout_de_production FLOAT;"),(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," ",(0,t.mdx)("code",null,"ALTER TABLE film MODIFY budget cout_de_production;"),(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Pour renommer un champ, on utilise une commande de type ALTER TABLE avec le mot cl\xe9 CHANGE suivi du nom du champ et de son nouveau nom. MySQL\noblige, on doit aussi repr\xe9ciser son type (ici FLOAT, car on l\u2019a modifi\xe9 \xe0 la question pr\xe9c\xe9dente).")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-7--comment-cr\xe9e-t-on-une-relation-plusieurs-\xe0-plusieurs-entre-deux-objets-existants-d\xe9j\xe0-en-base-"},"Question 7 : Comment cr\xe9e-t-on une relation plusieurs \xe0 plusieurs entre deux objets existants d\xe9j\xe0 en base ?"),(0,t.mdx)("i",{class:"bi bi-circle"})," On supprime et recr\xe9e les deux tables.",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-record-circle"})," On cr\xe9e une table de liaison qui va stocker les relations entre ces deux objets.",(0,t.mdx)("br",null),(0,t.mdx)("i",{class:"bi bi-circle"})," On joint les tables avec un JOIN.",(0,t.mdx)("br",null),(0,t.mdx)("br",null),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"Rappelez-vous, la table de liaison regroupe les relations plusieurs \xe0 plusieurs comme s\u2019il s\u2019agissait de relations un \xe0 plusieurs. Pour ce\nfaire, elle contient 2 colonnes, chacune \xe9tant une cl\xe9 \xe9trang\xe8re vers chaque objet de la relation plusieurs \xe0 plusieurs.")),(0,t.mdx)("hr",null),(0,t.mdx)("h4",{id:"question-8--quelle-est-la-commande-qui-permet-de-cr\xe9er-la-table-de-liaison-entre-film-et-pays_de_sortie-"},"Question 8 : Quelle est la commande qui permet de cr\xe9er la table de liaison entre \u201cfilm\u201d et \u201cpays_de_sortie\u201d ?"),(0,t.mdx)("i",{class:"bi bi-record-circle"}),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE film_pays_de_sortie (\nfilm_id INT NOT NULL,\npays_de_sortie_id INT NOT NULL,\nFOREIGN KEY (film_id) REFERENCES film (id) ON DELETE RESTRICT ON UPDATE CASCADE,\nFOREIGN KEY (pays_de_sortie_id) REFERENCES pays_de_sortie (id) ON DELETE RESTRICT ON UPDATE CASCADE,\nPRIMARY KEY (film_id, pays_de_sortie_id)\n);\n")),(0,t.mdx)("i",{class:"bi bi-circle"}),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE film_pays_de_sortie;\n")),(0,t.mdx)("i",{class:"bi bi-circle"}),(0,t.mdx)("pre",null,(0,t.mdx)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE film_pays_de_sortie (\nfilm_id INT NOT NULL,\npays_de_sortie_id INT NOT NULL\n);\n")),(0,t.mdx)("p",null,(0,t.mdx)("em",{parentName:"p"},"La table de liaison doit avoir pour nom \u201cnom_objet_1_nom_objet_2\u201d, soit ici \u201cfilm_pays_de_sortie\u201d et stocker deux champs, qui sont les cl\xe9s\n\xe9trang\xe8res de chaque autre table, soit ici \u201cfilm_id\u201d (cl\xe9 \xe9trang\xe8re vers l\u2019id de \u201cfilm\u201d) et \u201cpays_de_sortie_id\u201d (cl\xe9 \xe9trang\xe8re vers l\u2019id de\n\u201cpays_de_sortie\u201d).")))}c.isMDXComponent=!0}}]);